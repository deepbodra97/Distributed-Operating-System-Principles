function ignore(){}function id(n){return n}function fst(n){return n[0]}function snd(n){return n[1]}function trd(n){return n[2]}IntelliFactory={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i in n)t[i]=n[i];return t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return IntelliFactory.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:IntelliFactory.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};IntelliFactory.Runtime.OnLoad(function(){self.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});console||(console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore});
var JSON;JSON||(JSON={}),function(){"use strict";function i(n){return n<10?"0"+n:n}function f(n){return o.lastIndex=0,o.test(n)?'"'+n.replace(o,function(n){var t=s[n];return typeof t=="string"?t:"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+n+'"'}function r(i,e){var s,l,h,a,v=n,c,o=e[i];o&&typeof o=="object"&&typeof o.toJSON=="function"&&(o=o.toJSON(i));typeof t=="function"&&(o=t.call(e,i,o));switch(typeof o){case"string":return f(o);case"number":return isFinite(o)?String(o):"null";case"boolean":case"null":return String(o);case"object":if(!o)return"null";if(n+=u,c=[],Object.prototype.toString.apply(o)==="[object Array]"){for(a=o.length,s=0;s<a;s+=1)c[s]=r(s,o)||"null";return h=c.length===0?"[]":n?"[\n"+n+c.join(",\n"+n)+"\n"+v+"]":"["+c.join(",")+"]",n=v,h}if(t&&typeof t=="object")for(a=t.length,s=0;s<a;s+=1)typeof t[s]=="string"&&(l=t[s],h=r(l,o),h&&c.push(f(l)+(n?": ":":")+h));else for(l in o)Object.prototype.hasOwnProperty.call(o,l)&&(h=r(l,o),h&&c.push(f(l)+(n?": ":":")+h));return h=c.length===0?"{}":n?"{\n"+n+c.join(",\n"+n)+"\n"+v+"}":"{"+c.join(",")+"}",n=v,h}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+i(this.getUTCMonth()+1)+"-"+i(this.getUTCDate())+"T"+i(this.getUTCHours())+":"+i(this.getUTCMinutes())+":"+i(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,o=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n,u,s={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},t;typeof JSON.stringify!="function"&&(JSON.stringify=function(i,f,e){var o;if(n="",u="",typeof e=="number")for(o=0;o<e;o+=1)u+=" ";else typeof e=="string"&&(u=e);if(t=f,f&&typeof f!="function"&&(typeof f!="object"||typeof f.length!="number"))throw new Error("JSON.stringify");return r("",{"":i})});typeof JSON.parse!="function"&&(JSON.parse=function(n,t){function r(n,i){var f,e,u=n[i];if(u&&typeof u=="object")for(f in u)Object.prototype.hasOwnProperty.call(u,f)&&(e=r(u,f),e!==undefined?u[f]=e:delete u[f]);return t.call(n,i,u)}var i;if(n=String(n),e.lastIndex=0,e.test(n)&&(n=n.replace(e,function(n){return"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(n.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return i=eval("("+n+")"),typeof t=="function"?r({"":i},""):i;throw new SyntaxError("JSON.parse");})}();
/* https://github.com/jonathantneal/closest */
(function(w,p){p=w.Element.prototype
if(!p.matches){p.matches=p.msMatchesSelector||function(s){var m=(this.document||this.ownerDocument).querySelectorAll(s);for(var i=0;m[i]&&m[i]!==e;++i);return!!m[i]}}
if(!p.closest){p.closest=function(s){var e=this;while(e&&e.nodeType==1){if(e.matches(s))return e;e=e.parentNode}return null}}})(this);
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV;a=self;b=a.Client=a.Client||{};c=b.Client=b.Client||{};d=a.WebSharper=a.WebSharper||{};e=d.Unchecked=d.Unchecked||{};f=d.UI=d.UI||{};g=f.ListModel=f.ListModel||{};h=d.List=d.List||{};i=h.T=h.T||{};j=d.Obj=d.Obj||{};k=d.Operators=d.Operators||{};l=f.Templating=f.Templating||{};m=l.Runtime=l.Runtime||{};n=m.Server=m.Server||{};o=n.TemplateInstance=n.TemplateInstance||{};p=d.Arrays=d.Arrays||{};q=n.ProviderBuilder=n.ProviderBuilder||{};r=n.Handler=n.Handler||{};s=f.Var=f.Var||{};t=a.Client_Templates=a.Client_Templates||{};u=d.ClientSideJson=d.ClientSideJson||{};v=u.Provider=u.Provider||{};w=f.Storage=f.Storage||{};x=d.Seq=d.Seq||{};y=a.System=a.System||{};z=y.Guid=y.Guid||{};A=d.Collections=d.Collections||{};B=A.List=A.List||{};C=A.Dictionary=A.Dictionary||{};D=d.JavaScript=d.JavaScript||{};E=D.Pervasives=D.Pervasives||{};F=d.Concurrency=d.Concurrency||{};G=d.Strings=d.Strings||{};H=f.Client=f.Client||{};I=H.Templates=H.Templates||{};J=f.Doc=f.Doc||{};K=w.ArrayStorage=w.ArrayStorage||{};L=f.View=f.View||{};M=f.Snap=f.Snap||{};N=a.Object;O=f.AttrProxy=f.AttrProxy||{};P=f.CheckedInput=f.CheckedInput||{};Q=d.Numeric=d.Numeric||{};R=F.AsyncBody=F.AsyncBody||{};S=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};T=F.CT=F.CT||{};U=A.HashSet=A.HashSet||{};V=n.TemplateInitializer=n.TemplateInitializer||{};W=f.Var$1=f.Var$1||{};X=a.EventTarget;Y=a.Node;Z=D.JS=D.JS||{};_0=d.Enumerator=d.Enumerator||{};_1=A.DictionaryUtil=A.DictionaryUtil||{};_2=F.Scheduler=F.Scheduler||{};_3=d.CancellationTokenSource=d.CancellationTokenSource||{};_4=_0.T=_0.T||{};_5=f.ConcreteVar=f.ConcreteVar||{};_6=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};_7=a.WindowOrWorkerGlobalScope;_8=f.Docs=f.Docs||{};_9=f.DocElemNode=f.DocElemNode||{};_=a.CharacterData;$=a.Error;ba=d.OperationCanceledException=d.OperationCanceledException||{};bb=f.Abbrev=f.Abbrev||{};bc=bb.Fresh=bb.Fresh||{};bd=f.Elt=f.Elt||{};be=I.Prepare=I.Prepare||{};bf=d.Slice=d.Slice||{};bg=f.DomUtility=f.DomUtility||{};bh=A.KeyCollection=A.KeyCollection||{};bi=f.An=f.An||{};bj=H.Settings=H.Settings||{};bk=bb.Mailbox=bb.Mailbox||{};bl=H.Attrs=H.Attrs||{};bm=bl.Dyn=bl.Dyn||{};bn=f.Array=f.Array||{};bo=f.Attrs=f.Attrs||{};bp=f.AttrModule=f.AttrModule||{};bq=f.Updates=f.Updates||{};br=A.ValueCollection=A.ValueCollection||{};bs=H.Docs=H.Docs||{};bt=bs.RunState=bs.RunState||{};bu=bs.NodeSet=bs.NodeSet||{};bv=f.Anims=f.Anims||{};bw=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};bx=A.HashSetUtil=A.HashSetUtil||{};by=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};bz=f.BindVar=f.BindVar||{};bA=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};bB=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};bC=f.AppendList=f.AppendList||{};bD=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};bE=f.DynamicAttrNode=f.DynamicAttrNode||{};bF=f.Easing=f.Easing||{};bG=bb.HashSet=bb.HashSet||{};bH=f.String=f.String||{};bI=bs.DomNodes=bs.DomNodes||{};bJ=d.Queue=d.Queue||{};bK=d.Char=d.Char||{};bL=d.Lazy=d.Lazy||{};bM=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};bN=d.LazyExtensionsProxy=d.LazyExtensionsProxy||{};bO=bN.LazyRecord=bN.LazyRecord||{};bP=a.console;bQ=a.JSON;bR=a.jQuery;bS=a.IntelliFactory;bT=bS&&bS.Runtime;bU=a.Math;bV=a.Date;c.Main=function(){var bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8;function b9(cc){var cd;(function(ce){return ce("Sending registration request to server");}(function(ce){bP.log(ce);}));F.Start((cd=null,F.Delay(function(){return F.Bind(c.Ajax("POST","http://localhost:5000/api/users",bQ.stringify(((v.Id())())(cc))),function(ce){bW=cc;v.Id();bQ.parse(ce);return F.Return(null);});})),null);}function b_(cc){(function(cd){return cd("Sending login request to server");}(function(cd){bP.log(cd);}));bW=cc;}function b$(cc){var cd;(function(ce){return ce("Sending subscription request to server");}(function(ce){bP.log(ce);}));F.Start((cd=null,F.Delay(function(){return F.Bind(c.Ajax("POST","http://localhost:5000/api/users/subscribe",bQ.stringify(((v.Id())())(cc))),function(ce){v.Id();bQ.parse(ce);return F.Return(null);});})),null);}function ca(cc){var cd;(function(ce){return ce("Sending tweet to server");}(function(ce){bP.log(ce);}));F.Start((cd=null,F.Delay(function(){return F.Bind(c.Ajax("POST","http://localhost:5000/api/tweets",bQ.stringify(((v.Id())())(cc))),function(ce){v.Id();bQ.parse(ce);return F.Return(null);});})),null);}function cb(cc){var cd;(function(ce){return ce("Sending query to server");}(function(ce){bP.log(ce);}));cd=null;return F.Delay(function(){return F.Bind(c.Ajax("POST","http://localhost:5000/api/tweets/search",bQ.stringify(((v.Id())())(cc))),function(ce){return F.Return(((v.DecodeList(v.Id()))())(bQ.parse(ce)));});});}bW=null;bX=g.Create(function(cc){return cc.id;},i.Empty);bY=(bZ=(b0=J.Convert(function(cc){var cd,ce,cf,cg;return(cd=(ce=new q.New$1(),(ce.h.push({$:1,$0:"text",$1:cc.text}),ce)),(cf=r.CompleteHoles(cd.k,cd.h,[]),(cg=new o.New(cf[1],t.tweet(cf[0])),cd.i=cg,cg))).get_Doc();},bX.v),(b1=(b2=(b3=(b4=(b5=(b6=new q.New$1(),(b6.h.push(r.EventQ2(b6.k,"onregister",function(){return b6.i;},function(cc){b9({id:0,username:cc.Vars.Hole("regusername").$1.Get(),password:cc.Vars.Hole("regpassword").$1.Get()});cc.Vars.Hole("regusername").$1.Set("");cc.Vars.Hole("regpassword").$1.Set("");cc.Vars.Hole("regconfirmpassword").$1.Set("");})),b6)),(b5.h.push(r.EventQ2(b5.k,"onlogin",function(){return b5.i;},function(cc){b_({id:0,username:cc.Vars.Hole("logusername").$1.Get(),password:cc.Vars.Hole("logpassword").$1.Get()});})),b5)),(b4.h.push(r.EventQ2(b4.k,"onsubscribe",function(){return b4.i;},function(cc){b$({publisher:cc.Vars.Hole("publisher").$1.Get(),subscriber:bW.username});})),b4)),(b3.h.push(r.EventQ2(b3.k,"ontweet",function(){return b3.i;},function(cc){ca({id:"",reId:"",text:cc.Vars.Hole("tweettext").$1.Get(),tType:"tweet",by:"Deep"});})),b3)),(b2.h.push(r.EventQ2(b2.k,"onsearch",function(){return b2.i;},function(cc){var cd,ce,cf;bX.Clear();cd=cc.Vars.Hole("queryname").$1.Get();ce=cd===""?{qType:"subscription",qName:cd,by:bW.username}:G.StartsWith(cd,"#")?{qType:"hashtag",qName:cd,by:bW.username}:{qType:"mention",qName:cd,by:bW.username};F.Start((cf=null,F.Delay(function(){return F.Bind(cb(ce),function(cg){h.iter(function(ch){bX.Append(ch);},cg);return F.Zero();});})),null);})),b2)),(b1.h.push({$:0,$0:"queryresults",$1:b0}),b1))),(b7=r.CompleteHoles(bZ.k,bZ.h,[["regusername",0],["regpassword",0],["regconfirmpassword",0],["logusername",0],["logpassword",0],["publisher",0],["tweettext",0],["queryname",0]]),(b8=new o.New(b7[1],t.main(b7[0])),bZ.i=b8,b8))).get_Doc();I.LoadLocalTemplates("");J.RunById("main",bY);};c.Ajax=function(bW,bX,bY){function bZ(b0,b1){var b2;bR.ajax((b2={},b2.url=bX,b2.type=bW,b2.contentType="application/json",b2.dataType="text",b2.data=bY,b2.success=function(b3){return b0(b3);},b2.error=function(b3){return b1(new $(b3.responseText));},b2));}return F.FromContinuations(function(b0,b1,b2){return bZ.apply(null,[b0,b1,b2]);});};e.Equals=function(bW,bX){var bY,bZ,b0,b1;if(bW===bX)return true;else{bY=typeof bW;if(bY=="object"){if(bW===null||bW===void 0||bX===null||bX===void 0)return false;else if("Equals"in bW)return bW.Equals(bX);else if(bW instanceof a.Array&&bX instanceof a.Array)return e.arrayEquals(bW,bX);else if(bW instanceof a.Date&&bX instanceof a.Date)return e.dateEquals(bW,bX);else{bZ=[true];for(var b2 in bW)if(function(b3){bZ[0]=!bW.hasOwnProperty(b3)||bX.hasOwnProperty(b3)&&e.Equals(bW[b3],bX[b3]);return!bZ[0];}(b2))break;if(bZ[0]){for(var b3 in bX)if(function(b4){bZ[0]=!bX.hasOwnProperty(b4)||bW.hasOwnProperty(b4);return!bZ[0];}(b3))break;}return bZ[0];}}else return bY=="function"&&("$Func"in bW?bW.$Func===bX.$Func&&bW.$Target===bX.$Target:"$Invokes"in bW&&"$Invokes"in bX&&e.arrayEquals(bW.$Invokes,bX.$Invokes));}};e.arrayEquals=function(bW,bX){var bY,bZ;if(p.length(bW)===p.length(bX)){bY=true;bZ=0;while(bY&&bZ<p.length(bW)){!e.Equals(p.get(bW,bZ),p.get(bX,bZ))?bY=false:void 0;bZ=bZ+1;}return bY;}else return false;};e.dateEquals=function(bW,bX){return bW.getTime()===bX.getTime();};e.Hash=function(bW){var bX;bX=typeof bW;return bX=="function"?0:bX=="boolean"?bW?1:0:bX=="number"?bW:bX=="string"?e.hashString(bW):bX=="object"?bW==null?0:bW instanceof a.Array?e.hashArray(bW):e.hashObject(bW):0;};e.hashString=function(bW){var bX,bY,bZ;if(bW===null)return 0;else{bX=5381;for(bY=0,bZ=bW.length-1;bY<=bZ;bY++)bX=e.hashMix(bX,bW[bY].charCodeAt());return bX;}};e.hashArray=function(bW){var bX,bY,bZ;bX=-34948909;for(bY=0,bZ=p.length(bW)-1;bY<=bZ;bY++)bX=e.hashMix(bX,e.Hash(p.get(bW,bY)));return bX;};e.hashObject=function(bW){var bX,bY;if("GetHashCode"in bW)return bW.GetHashCode();else{bX=[0];for(var bZ in bW)if(function(b0){bX[0]=e.hashMix(e.hashMix(bX[0],e.hashString(b0)),e.Hash(bW[b0]));return false;}(bZ))break;return bX[0];}};e.hashMix=function(bW,bX){return(bW<<5)+bW+bX;};e.Compare=function(bW,bX){var bY,bZ,b0,b1,b2,b3;if(bW===bX)return 0;else{bZ=typeof bW;switch(bZ=="function"?1:bZ=="boolean"?2:bZ=="number"?2:bZ=="string"?2:bZ=="object"?3:0){case 0:return typeof bX=="undefined"?0:-1;case 1:return k.FailWith("Cannot compare function values.");case 2:return bW<bX?-1:1;case 3:if(bW===null)b0=-1;else if(bX===null)b0=1;else if("CompareTo"in bW)b0=bW.CompareTo(bX);else if("CompareTo0"in bW)b0=bW.CompareTo0(bX);else if(bW instanceof a.Array&&bX instanceof a.Array)b0=e.compareArrays(bW,bX);else if(bW instanceof a.Date&&bX instanceof a.Date)b0=e.compareDates(bW,bX);else{b1=[0];for(var b4 in bW)if(function(b5){return!bW.hasOwnProperty(b5)?false:!bX.hasOwnProperty(b5)?(b1[0]=1,true):(b1[0]=e.Compare(bW[b5],bX[b5]),b1[0]!==0);}(b4))break;if(b1[0]===0){for(var b5 in bX)if(function(b6){return!bX.hasOwnProperty(b6)?false:!bW.hasOwnProperty(b6)&&(b1[0]=-1,true);}(b5))break;}b0=b1[0];}return b0;}}};e.compareArrays=function(bW,bX){var bY,bZ;if(p.length(bW)<p.length(bX))return -1;else if(p.length(bW)>p.length(bX))return 1;else{bY=0;bZ=0;while(bY===0&&bZ<p.length(bW)){bY=e.Compare(p.get(bW,bZ),p.get(bX,bZ));bZ=bZ+1;}return bY;}};e.compareDates=function(bW,bX){return e.Compare(bW.getTime(),bX.getTime());};g.Create=function(bW,bX){return g.CreateWithStorage(bW,w.InMemory(p.ofSeq(bX)));};g.CreateWithStorage=function(bW,bX){return new g.New(bW,bX);};i=h.T=bT.Class({GetEnumerator:function(){return new _4.New(this,null,function(bW){var bX;bX=bW.s;return bX.$==0?false:(bW.c=bX.$0,bW.s=bX.$1,true);},void 0);},GetEnumerator0:function(){return _0.Get(this);}},null,i);i.Empty=new i({$:0});j=d.Obj=bT.Class({Equals:function(bW){return this===bW;},GetHashCode:function(){return -1;}},null,j);j.New=bT.Ctor(function(){},j);g=f.ListModel=bT.Class({Clear:function(){this["var"].Set(this.storage.SSet([]));this.ObsoleteAll();},Append:function(bW){var bX,bY,bZ,b0;bX=this;bY=this["var"].Get();bZ=this.key(bW);b0=p.tryFindIndex(function(b1){return e.Equals(bX.key(b1),bZ);},bY);b0!=null&&b0.$==1?this["var"].Set(this.storage.SSetAt(b0.$0,bW,bY)):this["var"].Set(this.storage.SAppend(bW,bY));this.ObsoleteKey(bZ);},ObsoleteAll:function(){x.iter(function(bW){M.Obsolete(bW.V);},this.it);this.it.Clear();},ObsoleteKey:function(bW){var bX,bY;bX=(bY=null,[this.it.TryGetValue(bW,{get:function(){return bY;},set:function(bZ){bY=bZ;}}),bY]);bX[0]?(M.Obsolete(bX[1]),this.it.Remove(bW)):void 0;},GetEnumerator:function(){return _0.Get(this["var"].Get());},GetEnumerator0:function(){return _0.Get0(this["var"].Get());}},j,g);g.New=bT.Ctor(function(bW,bX){g.New$3.call(this,bW,W.Create$1(p.ofSeq(x.distinctBy(bW,bX.SInit()))),bX);},g);g.New$3=bT.Ctor(function(bW,bX,bY){j.New.call(this);this.key=bW;this["var"]=bX;this.storage=bY;this.v=L.Map(function(bZ){return bZ.slice();},this["var"].get_View());this.it=new C.New$5();},g);k.FailWith=function(bW){throw new $(bW);};k.KeyValue=function(bW){return[bW.K,bW.V];};o=n.TemplateInstance=bT.Class({get_Doc:function(){return this.doc;},Hole:function(bW){return this.allVars.get_Item(bW);}},j,o);o.New=bT.Ctor(function(bW,bX){j.New.call(this);this.doc=bX;this.allVars=bW.$==0?bW.$0:k.FailWith("Should not happen");},o);p.get=function(bW,bX){p.checkBounds(bW,bX);return bW[bX];};p.length=function(bW){return bW.dims===2?bW.length*bW.length:bW.length;};p.checkBounds=function(bW,bX){if(bX<0||bX>=bW.length)k.FailWith("Index was outside the bounds of the array.");};p.set=function(bW,bX,bY){p.checkBounds(bW,bX);bW[bX]=bY;};q=n.ProviderBuilder=bT.Class({},j,q);q.New$1=bT.Ctor(function(){var bW;j.New.call(this);this.i=null;this.k=(bW=z.NewGuid(),a.String(bW));this.h=[];bT.SetOptional(this,"s",null);},q);r.EventQ2=function(bW,bX,bY,bZ){return{$:5,$0:bX,$1:function(b0){return function(b1){return bZ({Vars:bY(),Target:b0,Event:b1});};}};};r.CompleteHoles=function(bW,bX,bY){var b0,b1,b2,b3,b4;function bZ(b5,b6){var b7;return b1.Contains(b5)?null:(b7=b6===0?V.GetOrAddHoleFor(bW,b5,function(){return{$:8,$0:b5,$1:W.Create$1("")};}):b6===1?V.GetOrAddHoleFor(bW,b5,function(){return{$:13,$0:b5,$1:W.Create$1(0)};}):b6===2?V.GetOrAddHoleFor(bW,b5,function(){return{$:9,$0:b5,$1:W.Create$1(false)};}):k.FailWith("Invalid value type"),(b0.set_Item(b5,b7),{$:1,$0:b7}));}b0=new C.New$5();b1=new U.New$3();b2=_0.Get(bX);try{while(b2.MoveNext()){b3=b2.Current();b4=b3.$0;b1.Add(b4);b0.set_Item(b4,b3);}}finally{if(typeof b2=="object"&&"Dispose"in b2)b2.Dispose();}return[x.append(bX,p.choose(function(b5){return bZ(b5[0],b5[1]);},bY)),{$:0,$0:b0}];};s=f.Var=bT.Class({},j,s);s.New=bT.Ctor(function(){j.New.call(this);},s);h.iter=function(bW,bX){var bY;bY=bX;while(bY.$==1){bW(h.head(bY));bY=h.tail(bY);}};h.init=function(bW,bX){return h.ofArray(p.init(bW,bX));};h.head=function(bW){return bW.$==1?bW.$0:h.listEmpty();};h.tail=function(bW){return bW.$==1?bW.$1:h.listEmpty();};h.ofArray=function(bW){var bX,bY,bZ;bX=i.Empty;for(bY=p.length(bW)-1,bZ=0;bY>=bZ;bY--)bX=new i({$:1,$0:p.get(bW,bY),$1:bX});return bX;};h.listEmpty=function(){return k.FailWith("The input list was empty.");};t.tweet=function(bW){I.LoadLocalTemplates("index");return bW?I.NamedTemplate("index",{$:1,$0:"tweet"},bW):void 0;};t.main=function(bW){I.LoadLocalTemplates("index");return bW?I.NamedTemplate("index",{$:1,$0:"main"},bW):void 0;};v.Id=bT.Curried3(function(bW,bX,bY){return bY;});v.DecodeList=bT.Curried3(function(bW,bX,bY){var bZ;bZ=bW();return h.init(p.length(bY),function(b0){return bZ(p.get(bY,b0));});});w.InMemory=function(bW){return new K.New(bW);};x.iter=function(bW,bX){var bY;bY=_0.Get(bX);try{while(bY.MoveNext())bW(bY.Current());}finally{if(typeof bY=="object"&&"Dispose"in bY)bY.Dispose();}};x.append=function(bW,bX){return{GetEnumerator:function(){var bY,bZ;bY=_0.Get(bW);bZ=[true];return new _4.New(bY,null,function(b0){var b1;return b0.s.MoveNext()?(b0.c=b0.s.Current(),true):(b1=b0.s,!e.Equals(b1,null)?b1.Dispose():void 0,b0.s=null,bZ[0]&&(bZ[0]=false,b0.s=_0.Get(bX),b0.s.MoveNext()?(b0.c=b0.s.Current(),true):(b0.s.Dispose(),b0.s=null,false)));},function(b0){var b1;b1=b0.s;!e.Equals(b1,null)?b1.Dispose():void 0;});}};};x.distinctBy=function(bW,bX){return{GetEnumerator:function(){var bY,bZ;bY=_0.Get(bX);bZ=new U.New$3();return new _4.New(null,null,function(b0){var b1,b2;if(bY.MoveNext()){b1=bY.Current();b2=bZ.Add(bW(b1));while(!b2&&bY.MoveNext()){b1=bY.Current();b2=bZ.Add(bW(b1));}return b2&&(b0.c=b1,true);}else return false;},function(){bY.Dispose();});}};};x.head=function(bW){var bX;bX=_0.Get(bW);try{return bX.MoveNext()?bX.Current():x.insufficient();}finally{if(typeof bX=="object"&&"Dispose"in bX)bX.Dispose();}};x.fold=function(bW,bX,bY){var bZ,b0;bZ=bX;b0=_0.Get(bY);try{while(b0.MoveNext())bZ=bW(bZ,b0.Current());return bZ;}finally{if(typeof b0=="object"&&"Dispose"in b0)b0.Dispose();}};x.map=function(bW,bX){return{GetEnumerator:function(){var bY;bY=_0.Get(bX);return new _4.New(null,null,function(bZ){return bY.MoveNext()&&(bZ.c=bW(bY.Current()),true);},function(){bY.Dispose();});}};};x.max=function(bW){var bX,bY,bZ;bX=_0.Get(bW);try{if(!bX.MoveNext())x.seqEmpty();bY=bX.Current();while(bX.MoveNext()){bZ=bX.Current();e.Compare(bZ,bY)===1?bY=bZ:void 0;}return bY;}finally{if(typeof bX=="object"&&"Dispose"in bX)bX.Dispose();}};x.seqEmpty=function(){return k.FailWith("The input sequence was empty.");};x.forall=function(bW,bX){return!x.exists(function(bY){return!bW(bY);},bX);};x.exists=function(bW,bX){var bY,bZ;bY=_0.Get(bX);try{bZ=false;while(!bZ&&bY.MoveNext())bZ=bW(bY.Current());return bZ;}finally{if(typeof bY=="object"&&"Dispose"in bY)bY.Dispose();}};z.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new a.RegExp("[xy]","g"),function(bW){var bX,bY;bX=bU.random()*16|0;bY=bW=="x"?bX:bX&3|8;return bY.toString(16);});};B=A.List=bT.Class({GetEnumerator:function(){return _0.Get(this);},GetEnumerator0:function(){return _0.Get0(this);}},null,B);C=A.Dictionary=bT.Class({get_Item:function(bW){return this.get(bW);},get:function(bW){var bX,bY;bX=this;bY=this.data[this.hash(bW)];return bY==null?_1.notPresent():p.pick(function(bZ){var b0;b0=k.KeyValue(bZ);return bX.equals.apply(null,[b0[0],bW])?{$:1,$0:b0[1]}:null;},bY);},Clear:function(){this.data=[];this.count=0;},set_Item:function(bW,bX){this.set(bW,bX);},TryGetValue:function(bW,bX){var bY,bZ,b0;bY=this;bZ=this.data[this.hash(bW)];return bZ==null?false:(b0=p.tryPick(function(b1){var b2;b2=k.KeyValue(b1);return bY.equals.apply(null,[b2[0],bW])?{$:1,$0:b2[1]}:null;},bZ),b0!=null&&b0.$==1&&(bX.set(b0.$0),true));},Remove:function(bW){return this.remove(bW);},set:function(bW,bX){var bY,bZ,b0,b1;bY=this;bZ=this.hash(bW);b0=this.data[bZ];b0==null?(this.count=this.count+1,this.data[bZ]=new a.Array({K:bW,V:bX})):(b1=p.tryFindIndex(function(b2){return bY.equals.apply(null,[(k.KeyValue(b2))[0],bW]);},b0),b1==null?(this.count=this.count+1,b0.push({K:bW,V:bX})):b0[b1.$0]={K:bW,V:bX});},ContainsKey:function(bW){var bX,bY;bX=this;bY=this.data[this.hash(bW)];return bY==null?false:p.exists(function(bZ){return bX.equals.apply(null,[(k.KeyValue(bZ))[0],bW]);},bY);},get_Keys:function(){return new bh.New(this);},remove:function(bW){var bX,bY,bZ,b0;bX=this;bY=this.hash(bW);bZ=this.data[bY];return bZ==null?false:(b0=p.filter(function(b1){return!bX.equals.apply(null,[(k.KeyValue(b1))[0],bW]);},bZ),p.length(b0)<bZ.length&&(this.count=this.count-1,this.data[bY]=b0,true));},get_Values:function(){return new br.New(this);},GetEnumerator:function(){return _0.Get0(this);},GetEnumerator0:function(){return _0.Get0(p.concat(Z.GetFieldValues(this.data)));}},j,C);C.New$5=bT.Ctor(function(){C.New$6.call(this,[],e.Equals,e.Hash);},C);C.New$6=bT.Ctor(function(bW,bX,bY){var bZ,b0;j.New.call(this);this.equals=bX;this.hash=bY;this.count=0;this.data=[];bZ=_0.Get(bW);try{while(bZ.MoveNext()){b0=bZ.Current();this.set(b0.K,b0.V);}}finally{if(typeof bZ=="object"&&"Dispose"in bZ)bZ.Dispose();}},C);E.NewFromSeq=function(bW){var bX,bY,bZ;bX={};bY=_0.Get(bW);try{while(bY.MoveNext()){bZ=bY.Current();bX[bZ[0]]=bZ[1];}}finally{if(typeof bY=="object"&&"Dispose"in bY)bY.Dispose();}return bX;};F.Delay=function(bW){return function(bX){try{(bW(null))(bX);}catch(bY){bX.k({$:1,$0:bY});}};};F.Bind=function(bW,bX){return F.checkCancel(function(bY){bW(R.New(function(bZ){var b0;if(bZ.$==0){b0=bZ.$0;F.scheduler().Fork(function(){try{(bX(b0))(bY);}catch(b1){bY.k({$:1,$0:b1});}});}else F.scheduler().Fork(function(){bY.k(bZ);});},bY.ct));});};F.Zero=function(){S.$cctor();return S.Zero;};F.Start=function(bW,bX){var bY,bZ;bY=(bZ=(F.defCTS())[0],bX==null?bZ:bX.$0);F.scheduler().Fork(function(){if(!bY.c)bW(R.New(function(b0){if(b0.$==1)F.UncaughtAsyncError(b0.$0);},bY));});};F.Return=function(bW){return function(bX){bX.k({$:0,$0:bW});};};F.checkCancel=function(bW){return function(bX){if(bX.ct.c)F.cancel(bX);else bW(bX);};};F.defCTS=function(){S.$cctor();return S.defCTS;};F.UncaughtAsyncError=function(bW){bP.log("WebSharper: Uncaught asynchronous exception",bW);};F.FromContinuations=function(bW){return function(bX){var bY;function bZ(b0){if(bY[0])k.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{bY[0]=true;F.scheduler().Fork(b0);}}bY=[false];bW(function(b0){bZ(function(){bX.k({$:0,$0:b0});});},function(b0){bZ(function(){bX.k({$:1,$0:b0});});},function(b0){bZ(function(){bX.k({$:2,$0:b0});});});};};F.cancel=function(bW){bW.k({$:2,$0:new ba.New(bW.ct)});};F.scheduler=function(){S.$cctor();return S.scheduler;};G.StartsWith=function(bW,bX){return bW.substring(0,bX.length)==bX;};G.concat=function(bW,bX){return p.ofSeq(bX).join(bW);};G.SplitChars=function(bW,bX,bY){return G.Split(bW,new a.RegExp("["+G.RegexEscape(bX.join(""))+"]"),bY);};G.Split=function(bW,bX,bY){return bY===1?p.filter(function(bZ){return bZ!=="";},G.SplitWith(bW,bX)):G.SplitWith(bW,bX);};G.RegexEscape=function(bW){return bW.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};G.SplitWith=function(bW,bX){return bW.split(bX);};G.forall=function(bW,bX){return x.forall(bW,G.protect(bX));};G.protect=function(bW){return bW===null?"":bW;};I.LoadLocalTemplates=function(bW){!I.LocalTemplatesLoaded()?(I.set_LocalTemplatesLoaded(true),I.LoadNestedTemplates(self.document.body,"")):void 0;I.LoadedTemplates().set_Item(bW,I.LoadedTemplateFile(""));};I.NamedTemplate=function(bW,bX,bY){var bZ,b0;bZ=(b0=null,[I.LoadedTemplateFile(bW).TryGetValue(bX==null?"":bX.$0,{get:function(){return b0;},set:function(b1){b0=b1;}}),b0]);return bZ[0]?I.ChildrenTemplate(bZ[1].cloneNode(true),bY):(bP.warn("Local template doesn't exist",bX),J.get_Empty());};I.LocalTemplatesLoaded=function(){_6.$cctor();return _6.LocalTemplatesLoaded;};I.set_LocalTemplatesLoaded=function(bW){_6.$cctor();_6.LocalTemplatesLoaded=bW;};I.LoadNestedTemplates=function(bW,bX){var bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$;function bY(ca){var cb,cc;if(!bZ.ContainsKey(ca)){cb=(cc=null,[b0.TryGetValue(ca,{get:function(){return cc;},set:function(cd){cc=cd;}}),cc]);cb[0]?(b$.Add(ca),b0.Remove(ca),I.PrepareTemplateStrict(bX,{$:1,$0:ca},cb[1],{$:1,$0:bY})):bP.warn(b$.Contains(ca)?"Encountered loop when instantiating "+ca:"Local template does not exist: "+ca);}}bZ=I.LoadedTemplateFile(bX);b0=new C.New$5();b1=bW.querySelectorAll("[ws-template]");for(b2=0,b3=b1.length-1;b2<=b3;b2++){b4=b1[b2];b5=b4.getAttribute("ws-template").toLowerCase();b4.removeAttribute("ws-template");b0.set_Item(b5,I.FakeRootSingle(b4));}b6=bW.querySelectorAll("[ws-children-template]");for(b7=0,b8=b6.length-1;b7<=b8;b7++){b9=b6[b7];b_=b9.getAttribute("ws-children-template").toLowerCase();b9.removeAttribute("ws-children-template");b0.set_Item(b_,I.FakeRoot(b9));}b$=new U.New$3();while(b0.count>0)bY(x.head(b0.get_Keys()));};I.LoadedTemplates=function(){_6.$cctor();return _6.LoadedTemplates;};I.LoadedTemplateFile=function(bW){var bX,bY,bZ;bX=(bY=null,[I.LoadedTemplates().TryGetValue(bW,{get:function(){return bY;},set:function(b0){bY=b0;}}),bY]);return bX[0]?bX[1]:(bZ=new C.New$5(),(I.LoadedTemplates().set_Item(bW,bZ),bZ));};I.ChildrenTemplate=function(bW,bX){var bY,bZ,b0,b1,b2;bY=I.InlineTemplate(bW,x.append(bX,I.GlobalHoles().get_Values()));bZ=bY[1];b0=bY[0];b1=b0.Els;return!e.Equals(b1,null)&&b1.length===1&&(p.get(b1,0)instanceof Y&&(e.Equals(p.get(b1,0).nodeType,Y.ELEMENT_NODE)&&(b2=p.get(b1,0),true)))?bd.TreeNode(b0,bZ):J.Mk({$:6,$0:b0},bZ);};I.FakeRootSingle=function(bW){var bX,bY,bZ,b0;bW.removeAttribute("ws-template");bX=bW.getAttribute("ws-replace");bX===null?void 0:(bW.removeAttribute("ws-replace"),bY=bW.parentNode,e.Equals(bY,null)?void 0:(bZ=self.document.createElement(bW.tagName),bZ.setAttribute("ws-replace",bX),bY.replaceChild(bZ,bW)));b0=self.document.createElement("div");b0.appendChild(bW);return b0;};I.FakeRoot=function(bW){var bX;bX=self.document.createElement("div");while(bW.hasChildNodes())bX.appendChild(bW.firstChild);return bX;};I.PrepareTemplateStrict=function(bW,bX,bY,bZ){var b0;function b1(b7,b8){var b9,b_,b$,ca,cb,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx;function cc(cy){}while(true)switch(b7){case 0:if(b8!==null){b9=b8.nextSibling;if(e.Equals(b8.nodeType,Y.TEXT_NODE))be.convertTextNode(b8);else if(e.Equals(b8.nodeType,Y.ELEMENT_NODE))b3(b8);b8=b9;}else return null;break;case 1:cd=bf.string(b8.nodeName,{$:1,$0:3},null).toLowerCase();ce=(b_=cd.indexOf("."),b_===-1?[bW,cd]:[bf.string(cd,null,{$:1,$0:b_-1}),bf.string(cd,{$:1,$0:b_+1},null)]);cf=ce[1];cg=ce[0];if(cg!==""&&!I.LoadedTemplates().ContainsKey(cg))return be.failNotLoaded(cf);else{if(cg===""&&bZ!=null)bZ.$0(cf);ch=I.LoadedTemplates().get_Item(cg);if(!ch.ContainsKey(cf))return be.failNotLoaded(cf);else{ci=ch.get_Item(cf);cj=ci.cloneNode(true);ck=new U.New$3();cl=new C.New$5();cm=b8.attributes;for(cn=0,co=cm.length-1;cn<=co;cn++){cp=cm.item(cn).name.toLowerCase();cl.set_Item(cp,(cq=cm.item(cn).nodeValue,cq===""?cp:cq.toLowerCase()));!ck.Add(cp)?bP.warn("Hole mapped twice",cp):void 0;}for(cr=0,cs=b8.childNodes.length-1;cr<=cs;cr++){ct=b8.childNodes[cr];e.Equals(ct.nodeType,Y.ELEMENT_NODE)?!ck.Add(ct.nodeName.toLowerCase())?bP.warn("Hole filled twice",cf):void 0:void 0;}cu=b8.childNodes.length===1&&e.Equals(b8.firstChild.nodeType,Y.TEXT_NODE);if(cu){ca=be.fillTextHole(cj,b8.firstChild.textContent,cf);((function(cy){return function(cz){if(cz!=null)cy(cz.$0);};}((cb=function(cy){return function(cz){return cy.Add(cz);};}(ck),function(cy){return cc(cb(cy));})))(ca));}be.removeHolesExcept(cj,ck);if(!cu){for(cv=0,cw=b8.childNodes.length-1;cv<=cw;cv++){cx=b8.childNodes[cv];e.Equals(cx.nodeType,Y.ELEMENT_NODE)?cx.hasAttributes()?be.fillInstanceAttrs(cj,cx):b2(cj,cx):void 0;}}be.mapHoles(cj,cl);be.fill(cj,b8.parentNode,b8);b8.parentNode.removeChild(b8);return;}}break;}}function b2(b7,b8){var b9,b$,ca;function b_(cb,cc){var cd;if(b$==="title"&&b8.hasChildNodes()){cd=bg.ParseHTMLIntoFakeRoot(b8.textContent);b8.removeChild(b8.firstChild);while(cd.hasChildNodes())b8.appendChild(cd.firstChild);}else null;b3(b8);return be.fill(b8,cb,cc);}b$=b8.nodeName.toLowerCase();I.foreachNotPreserved(b7,"[ws-attr-holes]",function(cb){var cc,cd,ce,cf,cg;cc=G.SplitChars(cb.getAttribute("ws-attr-holes"),[" "],1);for(cd=0,ce=cc.length-1;cd<=ce;cd++){cf=p.get(cc,cd);cb.setAttribute(cf,(cg=new a.RegExp("\\${"+b$+"}","ig"),cb.getAttribute(cf).replace(cg,b8.textContent)));}});ca=b7.querySelector("[ws-hole="+b$+"]");if(e.Equals(ca,null)){b9=b7.querySelector("[ws-replace="+b$+"]");return e.Equals(b9,null)?null:(b_(b9.parentNode,b9),void b9.parentNode.removeChild(b9));}else{while(ca.hasChildNodes())ca.removeChild(ca.lastChild);ca.removeAttribute("ws-hole");return b_(ca,null);}}function b3(b7){if(!b7.hasAttribute("ws-preserve"))if(G.StartsWith(b7.nodeName.toLowerCase(),"ws-"))b5(b7);else{be.convertAttrs(b7);b4(b7.firstChild);}}function b4(b7){return b1(0,b7);}function b5(b7){return b1(1,b7);}function b6(b7){var b8,b9,b_,b$;while(true){b8=b7.querySelector("[ws-template]");if(e.Equals(b8,null)){b9=b7.querySelector("[ws-children-template]");if(e.Equals(b9,null))return null;else{b_=b9.getAttribute("ws-children-template");b9.removeAttribute("ws-children-template");I.PrepareTemplateStrict(bW,{$:1,$0:b_},b9,null);b7=b7;}}else{b$=b8.getAttribute("ws-template");(I.PrepareSingleTemplate(bW,{$:1,$0:b$},b8))(null);b7=b7;}}}b0=(bX==null?"":bX.$0).toLowerCase();I.LoadedTemplateFile(bW).set_Item(b0,bY);bY.hasChildNodes()?(b6(bY),b4(bY.firstChild)):void 0;};I.InlineTemplate=function(bW,bX){var bY,bZ,b0,b1,b4,b5,b6,b7,b8,b9,b_;function b2(b$,ca){var cb,cc,cd;cb=bo.Insert(b$,ca);b5.push(bo.Updates(cb));b6.push([b$,cb]);cc=bT.GetOptional(cb.OnAfterRender);return cc==null?null:(cd=cc.$0,void b7.push(function(){cd(b$);}));}function b3(b$){var ca,cb;ca=(cb=null,[b8.TryGetValue(b$,{get:function(){return cb;},set:function(cc){cb=cc;}}),cb]);return ca[0]?ca[1].$==0?{$:1,$0:ca[1].$1}:ca[1].$==1?{$:1,$0:J.TextNode(ca[1].$1)}:ca[1].$==2?{$:1,$0:J.TextView(ca[1].$1)}:ca[1].$==8?{$:1,$0:J.TextView(ca[1].$1.get_View())}:ca[1].$==9?{$:1,$0:J.TextView(L.Map(a.String,ca[1].$1.get_View()))}:ca[1].$==10?{$:1,$0:J.TextView(L.Map(function(cc){return cc.get_Input();},ca[1].$1.get_View()))}:ca[1].$==11?{$:1,$0:J.TextView(L.Map(a.String,ca[1].$1.get_View()))}:ca[1].$==12?{$:1,$0:J.TextView(L.Map(function(cc){return cc.get_Input();},ca[1].$1.get_View()))}:ca[1].$==13?{$:1,$0:J.TextView(L.Map(a.String,ca[1].$1.get_View()))}:(bP.warn("Content hole filled with attribute data",b$),null):null;}b4=[];b5=[];b6=[];b7=[];b8=new C.New$5();b9=_0.Get(bX);try{while(b9.MoveNext()){b_=b9.Current();b8.set_Item(b_.$0,b_);}}finally{if(typeof b9=="object"&&"Dispose"in b9)b9.Dispose();}bY=bg.ChildrenArray(bW);I.foreachNotPreserved(bW,"[ws-hole]",function(b$){var ca,cb,cc;cc=b$.getAttribute("ws-hole");b$.removeAttribute("ws-hole");while(b$.hasChildNodes())b$.removeChild(b$.lastChild);ca=b3(cc);ca!=null&&ca.$==1?(cb=ca.$0,_8.LinkElement(b$,cb.docNode),b4.push(_9.New(bo.Empty(b$),cb.docNode,null,b$,bc.Int(),null)),b5.push(cb.updates)):void 0;});I.foreachNotPreserved(bW,"[ws-replace]",function(b$){var ca,cb,cc,cd,ce,cf;ca=b3(b$.getAttribute("ws-replace"));ca!=null&&ca.$==1?(cb=ca.$0,cc=b$.parentNode,cd=self.document.createTextNode(""),cc.replaceChild(cd,b$),ce=_8.InsertBeforeDelim(cd,cb.docNode),cf=p.tryFindIndex(function(cg){return b$===cg;},bY),cf==null?void 0:p.set(bY,cf.$0,cb.docNode),b4.push(_9.New(bo.Empty(cc),cb.docNode,{$:1,$0:[ce,cd]},cc,bc.Int(),null)),b5.push(cb.updates)):void 0;});I.foreachNotPreserved(bW,"[ws-attr]",function(b$){var ca,cb,cc;ca=b$.getAttribute("ws-attr");b$.removeAttribute("ws-attr");cb=(cc=null,[b8.TryGetValue(ca,{get:function(){return cc;},set:function(cd){cc=cd;}}),cc]);cb[0]?cb[1].$==3?b2(b$,cb[1].$1):bP.warn("Attribute hole filled with non-attribute data",ca):void 0;});I.foreachNotPreserved(bW,"[ws-on]",function(b$){b2(b$,O.Concat(p.choose(function(ca){var cb,cc,cd;cb=G.SplitChars(ca,[":"],1);cc=(cd=null,[b8.TryGetValue(p.get(cb,1),{get:function(){return cd;},set:function(ce){cd=ce;}}),cd]);return cc[0]?cc[1].$==4?{$:1,$0:bp.Handler(p.get(cb,0),cc[1].$1)}:cc[1].$==5?{$:1,$0:O.Handler(p.get(cb,0),cc[1].$1)}:(bP.warn("Event hole on"+p.get(cb,0)+" filled with non-event data",p.get(cb,1)),null):null;},G.SplitChars(b$.getAttribute("ws-on"),[" "],1))));b$.removeAttribute("ws-on");});I.foreachNotPreserved(bW,"[ws-onafterrender]",function(b$){var ca,cb,cc;ca=b$.getAttribute("ws-onafterrender");cb=(cc=null,[b8.TryGetValue(ca,{get:function(){return cc;},set:function(cd){cc=cd;}}),cc]);cb[0]?cb[1].$==6?(b$.removeAttribute("ws-onafterrender"),b2(b$,bp.OnAfterRender(cb[1].$1))):cb[1].$==7?(b$.removeAttribute("ws-onafterrender"),b2(b$,bp.OnAfterRender(cb[1].$1))):bP.warn("onafterrender hole filled with non-onafterrender data",ca):void 0;});I.foreachNotPreserved(bW,"[ws-var]",function(b$){var ca,cb,cc;ca=b$.getAttribute("ws-var");b$.removeAttribute("ws-var");cb=(cc=null,[b8.TryGetValue(ca,{get:function(){return cc;},set:function(cd){cc=cd;}}),cc]);cb[0]?cb[1].$==8?b2(b$,bp.Value(cb[1].$1)):cb[1].$==9?b2(b$,bp.Checked(cb[1].$1)):cb[1].$==10?b2(b$,bp.IntValue(cb[1].$1)):cb[1].$==11?b2(b$,bp.IntValueUnchecked(cb[1].$1)):cb[1].$==12?b2(b$,bp.FloatValue(cb[1].$1)):cb[1].$==13?b2(b$,bp.FloatValueUnchecked(cb[1].$1)):bP.warn("Var hole filled with non-Var data",ca):void 0;});I.foreachNotPreserved(bW,"[ws-attr-holes]",function(b$){var ca,cb,cc,cd;ca=new a.RegExp(I.TextHoleRE(),"g");cb=G.SplitChars(b$.getAttribute("ws-attr-holes"),[" "],1);b$.removeAttribute("ws-attr-holes");for(cc=0,cd=cb.length-1;cc<=cd;cc++)(function(){var ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq;cn=p.get(cb,cc);co=b$.getAttribute(cn);ce=null;cf=0;cp=[];while(ce=ca.exec(co),ce!==null){cq=bf.string(co,{$:1,$0:cf},{$:1,$0:ca.lastIndex-p.get(ce,0).length-1});cf=ca.lastIndex;cp.push([cq,p.get(ce,1)]);}ch=bf.string(co,{$:1,$0:cf},null);ca.lastIndex=0;ci=p.foldBack(function(cr,cs){return(function(ct){var cu,cv;cu=ct[0];cv=ct[1];return function(cw){var cx,cy,cz,cA,cB;cx=cw[0];cy=cw[1];cz=(cA=(cB=null,[b8.TryGetValue(cv,{get:function(){return cB;},set:function(cC){cB=cC;}}),cB]),cA[0]?cA[1].$==1?{$:0,$0:cA[1].$1}:cA[1].$==2?{$:1,$0:cA[1].$1}:cA[1].$==8?{$:1,$0:cA[1].$1.get_View()}:cA[1].$==9?{$:1,$0:L.Map(a.String,cA[1].$1.get_View())}:cA[1].$==10?{$:1,$0:L.Map(function(cC){return cC.get_Input();},cA[1].$1.get_View())}:cA[1].$==11?{$:1,$0:L.Map(a.String,cA[1].$1.get_View())}:cA[1].$==12?{$:1,$0:L.Map(function(cC){return cC.get_Input();},cA[1].$1.get_View())}:cA[1].$==13?{$:1,$0:L.Map(a.String,cA[1].$1.get_View())}:(bP.warn("Attribute value hole filled with non-text data",cv),{$:0,$0:""}):{$:0,$0:""});return cz.$==1?[cu,new i({$:1,$0:cx===""?cz.$0:L.Map(function(cC){return cC+cx;},cz.$0),$1:cy})]:[cu+cz.$0+cx,cy];};}(cr))(cs);},cp,[ch,i.Empty]);return b2(b$,ci[1].$==1?ci[1].$1.$==1?ci[1].$1.$1.$==1?ci[1].$1.$1.$1.$==0?(cj=ci[0],bp.Dynamic(cn,L.Map3(function(cr,cs,ct){return cj+cr+cs+ct;},ci[1].$0,ci[1].$1.$0,ci[1].$1.$1.$0))):(ck=ci[0],bp.Dynamic(cn,L.Map(function(cr){return ck+G.concat("",cr);},L.Sequence(ci[1])))):(cl=ci[0],bp.Dynamic(cn,L.Map2(function(cr,cs){return cl+cr+cs;},ci[1].$0,ci[1].$1.$0))):ci[0]===""?bp.Dynamic(cn,ci[1].$0):(cm=ci[0],bp.Dynamic(cn,L.Map(function(cr){return cm+cr;},ci[1].$0))):O.Create(cn,ci[0]));}());});return[bT.DeleteEmptyFields({Els:bY,Dirty:true,Holes:b4,Attrs:b6,Render:(bZ=b7.length==0?null:{$:1,$0:function(b$){p.iter(function(ca){ca(b$);},b7);}},bZ?bZ.$0:void 0),El:(b0=!e.Equals(bY,null)&&bY.length===1&&(p.get(bY,0)instanceof Y&&(p.get(bY,0)instanceof a.Element&&(b1=p.get(bY,0),true)))?{$:1,$0:b1}:null,b0?b0.$0:void 0)},["Render","El"]),bn.TreeReduce(L.Const(),L.Map2Unit,b5)];};I.GlobalHoles=function(){_6.$cctor();return _6.GlobalHoles;};I.foreachNotPreserved=function(bW,bX,bY){bg.IterSelector(bW,bX,function(bZ){if(bZ.closest("[ws-preserve]")==null)bY(bZ);});};I.PrepareSingleTemplate=function(bW,bX,bY){var bZ;bZ=I.FakeRootSingle(bY);return function(b0){I.PrepareTemplateStrict(bW,bX,bZ,b0);};};I.TextHoleRE=function(){_6.$cctor();return _6.TextHoleRE;};J=f.Doc=bT.Class({},j,J);J.RunById=function(bW,bX){var bY;bY=self.document.getElementById(bW);e.Equals(bY,null)?k.FailWith("invalid id: "+bW):J.Run(bY,bX);};J.Convert=function(bW,bX){return J.Flatten(L.MapSeqCached(bW,bX));};J.Run=function(bW,bX){_8.LinkElement(bW,bX.docNode);J.RunInPlace(false,bW,bX);};J.Flatten=function(bW){return J.EmbedView(L.Map(J.Concat,bW));};J.get_Empty=function(){return J.Mk(null,L.Const());};J.RunInPlace=function(bW,bX,bY){var bZ;bZ=_8.CreateRunState(bX,bY.docNode);L.Sink(bi.get_UseAnimations()||bj.BatchUpdatesEnabled()?bk.StartProcessor(_8.PerformAnimatedUpdate(bW,bZ,bY.docNode)):function(){_8.PerformSyncUpdate(bW,bZ,bY.docNode);},bY.updates);};J.Concat=function(bW){var bX;bX=bn.ofSeqNonCopying(bW);return bn.TreeReduce(J.get_Empty(),J.Append,bX);};J.EmbedView=function(bW){var bX;bX=_8.CreateEmbedNode();return J.Mk({$:2,$0:bX},L.Map(a.ignore,L.Bind(function(bY){_8.UpdateEmbedNode(bX,bY.docNode);return bY.updates;},bW)));};J.Mk=function(bW,bX){return new J.New(bW,bX);};J.Append=function(bW,bX){return J.Mk({$:0,$0:bW.docNode,$1:bX.docNode},L.Map2Unit(bW.updates,bX.updates));};J.TextNode=function(bW){return J.Mk({$:5,$0:self.document.createTextNode(bW)},L.Const());};J.TextView=function(bW){var bX;bX=_8.CreateTextNode();return J.Mk({$:4,$0:bX},L.Map(function(bY){_8.UpdateTextNode(bX,bY);},bW));};J.New=bT.Ctor(function(bW,bX){j.New.call(this);this.docNode=bW;this.updates=bX;},J);K=w.ArrayStorage=bT.Class({SSet:function(bW){return p.ofSeq(bW);},SSetAt:function(bW,bX,bY){p.set(bY,bW,bX);return bY;},SAppend:function(bW,bX){bX.push(bW);return bX;},SInit:function(){return this.init;}},j,K);K.New=bT.Ctor(function(bW){j.New.call(this);this.init=bW;},K);p.ofSeq=function(bW){var bX,bY;if(bW instanceof a.Array)return bW.slice();else if(bW instanceof i)return p.ofList(bW);else{bX=[];bY=_0.Get(bW);try{while(bY.MoveNext())bX.push(bY.Current());return bX;}finally{if(typeof bY=="object"&&"Dispose"in bY)bY.Dispose();}}};p.tryFindIndex=function(bW,bX){var bY,bZ;bY=null;bZ=0;while(bZ<bX.length&&bY==null){bW(bX[bZ])?bY={$:1,$0:bZ}:void 0;bZ=bZ+1;}return bY;};p.choose=function(bW,bX){var bY,bZ,b0,b1;bY=[];for(bZ=0,b0=bX.length-1;bZ<=b0;bZ++){b1=bW(bX[bZ]);b1==null?void 0:bY.push(b1.$0);}return bY;};p.init=function(bW,bX){var bY,bZ,b0;bW<0?k.FailWith("Negative size given."):null;bY=new a.Array(bW);for(bZ=0,b0=bW-1;bZ<=b0;bZ++)bY[bZ]=bX(bZ);return bY;};p.ofList=function(bW){var bX,bY;bY=[];bX=bW;while(!(bX.$==0)){bY.push(h.head(bX));bX=h.tail(bX);}return bY;};p.pick=function(bW,bX){var bY;bY=p.tryPick(bW,bX);return bY==null?k.FailWith("KeyNotFoundException"):bY.$0;};p.tryPick=function(bW,bX){var bY,bZ,b0;bY=null;bZ=0;while(bZ<bX.length&&bY==null){b0=bW(bX[bZ]);b0!=null&&b0.$==1?bY=b0:void 0;bZ=bZ+1;}return bY;};p.exists=function(bW,bX){var bY,bZ,b0,b1;bY=false;bZ=0;b1=p.length(bX);while(!bY&&bZ<b1)if(bW(bX[bZ]))bY=true;else bZ=bZ+1;return bY;};p.concat=function(bW){return a.Array.prototype.concat.apply([],p.ofSeq(bW));};p.filter=function(bW,bX){var bY,bZ,b0;bY=[];for(bZ=0,b0=bX.length-1;bZ<=b0;bZ++)if(bW(bX[bZ]))bY.push(bX[bZ]);return bY;};p.foldBack=function(bW,bX,bY){var bZ,b0,b1,b2,b3;bZ=bY;b1=bX.length;for(b2=1,b3=b1;b2<=b3;b2++)bZ=bW(bX[b1-b2],bZ);return bZ;};p.iter=function(bW,bX){var bY,bZ;for(bY=0,bZ=bX.length-1;bY<=bZ;bY++)bW(bX[bY]);};p.map=function(bW,bX){var bY,bZ,b0;bY=new a.Array(bX.length);for(bZ=0,b0=bX.length-1;bZ<=b0;bZ++)bY[bZ]=bW(bX[bZ]);return bY;};p.forall=function(bW,bX){var bY,bZ,b0,b1;bY=true;bZ=0;b1=p.length(bX);while(bY&&bZ<b1)if(bW(bX[bZ]))bZ=bZ+1;else bY=false;return bY;};p.create=function(bW,bX){var bY,bZ,b0;bY=new a.Array(bW);for(bZ=0,b0=bW-1;bZ<=b0;bZ++)bY[bZ]=bX;return bY;};L=f.View=bT.Class({},null,L);M.Obsolete=function(bW){var bX,bY,bZ,b0,b1;bY=bW.s;if(bY==null||(bY!=null&&bY.$==2?(bX=bY.$1,false):bY!=null&&bY.$==3?(bX=bY.$1,false):true))void 0;else{bW.s=null;for(bZ=0,b0=p.length(bX)-1;bZ<=b0;bZ++){b1=p.get(bX,bZ);typeof b1=="object"?function(b2){M.Obsolete(b2);}(b1):b1();}}};M.New=function(bW){return{s:bW};};O=f.AttrProxy=bT.Class({},null,O);O.Handler=function(bW,bX){return O.HandlerImpl(bW,bX);};O.Concat=function(bW){var bX;bX=bn.ofSeqNonCopying(bW);return bn.TreeReduce(bo.EmptyAttr(),O.Append,bX);};O.Create=function(bW,bX){return bo.Static(function(bY){bY.setAttribute(bW,bX);});};O.HandlerImpl=function(bW,bX){return bo.Static(function(bY){bY.addEventListener(bW,function(bZ){return(bX(bY))(bZ);},false);});};O.Append=function(bW,bX){return bo.AppendTree(bW,bX);};P=f.CheckedInput=bT.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,P);Q.TryParseInt32=function(bW,bX){return Q.TryParse(bW,-2147483648,2147483647,bX);};M.Map=function(bW,bX){var bY,bZ;bY=bX.s;return bY!=null&&bY.$==0?M.New({$:0,$0:bW(bY.$0)}):(bZ=M.New({$:3,$0:[],$1:[]}),(M.When(bX,function(b0){M.MarkDone(bZ,bX,bW(b0));},bZ),bZ));};M.WhenRun=function(bW,bX,bY){var bZ;bZ=bW.s;bZ==null?bY():bZ!=null&&bZ.$==2?(bZ.$1.push(bY),bX(bZ.$0)):bZ!=null&&bZ.$==3?(bZ.$0.push(bX),bZ.$1.push(bY)):bX(bZ.$0);};M.WhenObsoleteRun=function(bW,bX){var bY;bY=bW.s;bY==null?bX():bY!=null&&bY.$==2?bY.$1.push(bX):bY!=null&&bY.$==3?bY.$1.push(bX):void 0;};M.When=function(bW,bX,bY){var bZ;bZ=bW.s;bZ==null?M.Obsolete(bY):bZ!=null&&bZ.$==2?(M.EnqueueSafe(bZ.$1,bY),bX(bZ.$0)):bZ!=null&&bZ.$==3?(bZ.$0.push(bX),M.EnqueueSafe(bZ.$1,bY)):bX(bZ.$0);};M.MarkDone=function(bW,bX,bY){var bZ;if(bZ=bX.s,bZ!=null&&bZ.$==0)M.MarkForever(bW,bY);else M.MarkReady(bW,bY);};M.Map3=function(bW,bX,bY,bZ){var b0,b1,b2,b3;function b4(b5){var b6,b7,b8,b9;if(!(b6=b3.s,b6!=null&&b6.$==0||b6!=null&&b6.$==2)){b7=M.ValueAndForever(bX);b8=M.ValueAndForever(bY);b9=M.ValueAndForever(bZ);b7!=null&&b7.$==1?b8!=null&&b8.$==1?b9!=null&&b9.$==1?b7.$0[1]&&b8.$0[1]&&b9.$0[1]?M.MarkForever(b3,bW(b7.$0[0],b8.$0[0],b9.$0[0])):M.MarkReady(b3,bW(b7.$0[0],b8.$0[0],b9.$0[0])):void 0:void 0:void 0;}}b0=bX.s;b1=bY.s;b2=bZ.s;return b0!=null&&b0.$==0?b1!=null&&b1.$==0?b2!=null&&b2.$==0?M.New({$:0,$0:bW(b0.$0,b1.$0,b2.$0)}):M.Map3Opt1(bW,b0.$0,b1.$0,bZ):b2!=null&&b2.$==0?M.Map3Opt2(bW,b0.$0,b2.$0,bY):M.Map3Opt3(bW,b0.$0,bY,bZ):b1!=null&&b1.$==0?b2!=null&&b2.$==0?M.Map3Opt4(bW,b1.$0,b2.$0,bX):M.Map3Opt5(bW,b1.$0,bX,bZ):b2!=null&&b2.$==0?M.Map3Opt6(bW,b2.$0,bX,bY):(b3=M.New({$:3,$0:[],$1:[]}),(M.When(bX,b4,b3),M.When(bY,b4,b3),M.When(bZ,b4,b3),b3));};M.Sequence=function(bW){var bX,bY,bZ;function b0(b1){var b2;if(bZ[0]===0){b2=p.map(function(b3){var b4;b4=b3.s;return b4!=null&&b4.$==0?b4.$0:b4!=null&&b4.$==2?b4.$0:k.FailWith("value not found by View.Sequence");},bX);p.forall(function(b3){var b4;b4=b3.s;return b4!=null&&b4.$==0;},bX)?M.MarkForever(bY,b2):M.MarkReady(bY,b2);}else bZ[0]--;}bX=p.ofSeq(bW);return bX.length==0?M.New({$:0,$0:[]}):(bY=M.New({$:3,$0:[],$1:[]}),(bZ=[p.length(bX)-1],(p.iter(function(b1){M.When(b1,b0,bY);},bX),bY)));};M.Map2=function(bW,bX,bY){var bZ,b0,b1;function b2(b3){var b4,b5,b6;if(!(b4=b1.s,b4!=null&&b4.$==0||b4!=null&&b4.$==2)){b5=M.ValueAndForever(bX);b6=M.ValueAndForever(bY);b5!=null&&b5.$==1?b6!=null&&b6.$==1?b5.$0[1]&&b6.$0[1]?M.MarkForever(b1,bW(b5.$0[0],b6.$0[0])):M.MarkReady(b1,bW(b5.$0[0],b6.$0[0])):void 0:void 0;}}bZ=bX.s;b0=bY.s;return bZ!=null&&bZ.$==0?b0!=null&&b0.$==0?M.New({$:0,$0:bW(bZ.$0,b0.$0)}):M.Map2Opt1(bW,bZ.$0,bY):b0!=null&&b0.$==0?M.Map2Opt2(bW,b0.$0,bX):(b1=M.New({$:3,$0:[],$1:[]}),(M.When(bX,b2,b1),M.When(bY,b2,b1),b1));};M.Map2Unit=function(bW,bX){var bY,bZ,b0;function b1(){var b2,b3,b4;if(!(b2=b0.s,b2!=null&&b2.$==0||b2!=null&&b2.$==2)){b3=M.ValueAndForever(bW);b4=M.ValueAndForever(bX);b3!=null&&b3.$==1?b4!=null&&b4.$==1?b3.$0[1]&&b4.$0[1]?M.MarkForever(b0,null):M.MarkReady(b0,null):void 0:void 0;}}bY=bW.s;bZ=bX.s;return bY!=null&&bY.$==0?bZ!=null&&bZ.$==0?M.New({$:0,$0:null}):bX:bZ!=null&&bZ.$==0?bW:(b0=M.New({$:3,$0:[],$1:[]}),(M.When(bW,b1,b0),M.When(bX,b1,b0),b0));};M.Copy=function(bW){var bX,bY,bZ;bX=bW.s;return bX==null?bW:bX!=null&&bX.$==2?(bY=M.New({$:2,$0:bX.$0,$1:[]}),(M.WhenObsolete(bW,bY),bY)):bX!=null&&bX.$==3?(bZ=M.New({$:3,$0:[],$1:[]}),(M.When(bW,function(b0){M.MarkDone(bZ,bW,b0);},bZ),bZ)):bW;};M.EnqueueSafe=function(bW,bX){var bY,bZ,b0,b1;bW.push(bX);if(bW.length%20===0){bY=bW.slice(0);bJ.Clear(bW);for(bZ=0,b0=p.length(bY)-1;bZ<=b0;bZ++){b1=p.get(bY,bZ);typeof b1=="object"?function(b2){if(b2.s)bW.push(b2);}(b1):function(b2){bW.push(b2);}(b1);}}else void 0;};M.MarkForever=function(bW,bX){var bY,bZ,b0,b1;bY=bW.s;if(bY!=null&&bY.$==3){bW.s={$:0,$0:bX};bZ=bY.$0;for(b0=0,b1=p.length(bZ)-1;b0<=b1;b0++)(p.get(bZ,b0))(bX);}else void 0;};M.MarkReady=function(bW,bX){var bY,bZ,b0,b1;bY=bW.s;if(bY!=null&&bY.$==3){bW.s={$:2,$0:bX,$1:bY.$1};bZ=bY.$0;for(b0=0,b1=p.length(bZ)-1;b0<=b1;b0++)(p.get(bZ,b0))(bX);}else void 0;};M.Join=function(bW){var bX;bX=M.New({$:3,$0:[],$1:[]});M.When(bW,function(bY){var bZ;bZ=bY();M.When(bZ,function(b0){var b1,b2;if((b1=bZ.s,b1!=null&&b1.$==0)&&(b2=bW.s,b2!=null&&b2.$==0))M.MarkForever(bX,b0);else M.MarkReady(bX,b0);},bX);},bX);return bX;};M.Map3Opt1=function(bW,bX,bY,bZ){return M.Map(function(b0){return bW(bX,bY,b0);},bZ);};M.Map3Opt2=function(bW,bX,bY,bZ){return M.Map(function(b0){return bW(bX,b0,bY);},bZ);};M.Map3Opt3=function(bW,bX,bY,bZ){return M.Map2(function(b0,b1){return bW(bX,b0,b1);},bY,bZ);};M.Map3Opt4=function(bW,bX,bY,bZ){return M.Map(function(b0){return bW(b0,bX,bY);},bZ);};M.Map3Opt5=function(bW,bX,bY,bZ){return M.Map2(function(b0,b1){return bW(b0,bX,b1);},bY,bZ);};M.Map3Opt6=function(bW,bX,bY,bZ){return M.Map2(function(b0,b1){return bW(b0,b1,bX);},bY,bZ);};M.ValueAndForever=function(bW){var bX;bX=bW.s;return bX!=null&&bX.$==0?{$:1,$0:[bX.$0,true]}:bX!=null&&bX.$==2?{$:1,$0:[bX.$0,false]}:null;};M.Map2Opt1=function(bW,bX,bY){return M.Map(function(bZ){return bW(bX,bZ);},bY);};M.Map2Opt2=function(bW,bX,bY){return M.Map(function(bZ){return bW(bZ,bX);},bY);};M.WhenObsolete=function(bW,bX){var bY;bY=bW.s;bY==null?M.Obsolete(bX):bY!=null&&bY.$==2?M.EnqueueSafe(bY.$1,bX):bY!=null&&bY.$==3?M.EnqueueSafe(bY.$1,bX):void 0;};R.New=function(bW,bX){return{k:bW,ct:bX};};S.$cctor=function(){S.$cctor=a.ignore;S.noneCT=T.New(false,[]);S.scheduler=new _2.New();S.defCTS=[new _3.New()];S.Zero=F.Return();S.GetCT=function(bW){bW.k({$:0,$0:bW.ct});};};T.New=function(bW,bX){return{c:bW,r:bX};};U=A.HashSet=bT.Class({Add:function(bW){return this.add(bW);},Contains:function(bW){var bX;bX=this.data[this.hash(bW)];return bX==null?false:this.arrContains(bW,bX);},add:function(bW){var bX,bY;bX=this.hash(bW);bY=this.data[bX];return bY==null?(this.data[bX]=[bW],this.count=this.count+1,true):this.arrContains(bW,bY)?false:(bY.push(bW),this.count=this.count+1,true);},arrContains:function(bW,bX){var bY,bZ,b0,b1;bY=true;bZ=0;b1=bX.length;while(bY&&bZ<b1)if(this.equals.apply(null,[bX[bZ],bW]))bY=false;else bZ=bZ+1;return!bY;},ExceptWith:function(bW){var bX;bX=_0.Get(bW);try{while(bX.MoveNext())this.Remove(bX.Current());}finally{if(typeof bX=="object"&&"Dispose"in bX)bX.Dispose();}},get_Count:function(){return this.count;},CopyTo:function(bW){var bX,bY,bZ,b0;bX=0;bY=bx.concat(this.data);for(bZ=0,b0=bY.length-1;bZ<=b0;bZ++)p.set(bW,bZ,bY[bZ]);},IntersectWith:function(bW){var bX,bY,bZ,b0,b1;bX=new U.New$4(bW,this.equals,this.hash);bY=bx.concat(this.data);for(bZ=0,b0=bY.length-1;bZ<=b0;bZ++){b1=bY[bZ];!bX.Contains(b1)?this.Remove(b1):void 0;}},Remove:function(bW){var bX;bX=this.data[this.hash(bW)];return bX==null?false:this.arrRemove(bW,bX)&&(this.count=this.count-1,true);},arrRemove:function(bW,bX){var bY,bZ,b0,b1;bY=true;bZ=0;b1=bX.length;while(bY&&bZ<b1)if(this.equals.apply(null,[bX[bZ],bW])){bX.splice.apply(bX,[bZ,1]);bY=false;}else bZ=bZ+1;return!bY;},GetEnumerator:function(){return _0.Get(bx.concat(this.data));},GetEnumerator0:function(){return _0.Get(bx.concat(this.data));}},j,U);U.New$3=bT.Ctor(function(){U.New$4.call(this,[],e.Equals,e.Hash);},U);U.New$4=bT.Ctor(function(bW,bX,bY){var bZ;j.New.call(this);this.equals=bX;this.hash=bY;this.data=[];this.count=0;bZ=_0.Get(bW);try{while(bZ.MoveNext())this.add(bZ.Current());}finally{if(typeof bZ=="object"&&"Dispose"in bZ)bZ.Dispose();}},U);U.New$2=bT.Ctor(function(bW){U.New$4.call(this,bW,e.Equals,e.Hash);},U);V.$cctor=function(){V.$cctor=a.ignore;V.initialized=new C.New$5();};V=n.TemplateInitializer=bT.Class({},j,V);V.GetOrAddHoleFor=function(bW,bX,bY){var bZ,b0,b1,b2;V.$cctor();bZ=V.GetHolesFor(bW);b0=(b1=null,[bZ.TryGetValue(bX,{get:function(){return b1;},set:function(b3){b1=b3;}}),b1]);return b0[0]?b0[1]:(b2=bY(),(bZ.set_Item(bX,b2),b2));};V.GetHolesFor=function(bW){var bX,bY,bZ;V.$cctor();bX=(bY=null,[V.initialized.TryGetValue(bW,{get:function(){return bY;},set:function(b0){bY=b0;}}),bY]);return bX[0]?bX[1]:(bZ=new C.New$5(),(V.initialized.set_Item(bW,bZ),bZ));};W=f.Var$1=bT.Class({},j,W);W.Create$1=function(bW){return new _5.New(false,M.New({$:2,$0:bW,$1:[]}),bW);};Z.GetFieldValues=function(bW){var bX,bY;bX=[];for(var bZ in bW)bX.push(bW[bZ]);return bX;};_0.Get=function(bW){return bW instanceof a.Array?_0.ArrayEnumerator(bW):e.Equals(typeof bW,"string")?_0.StringEnumerator(bW):bW.GetEnumerator();};_0.ArrayEnumerator=function(bW){return new _4.New(0,null,function(bX){var bY;bY=bX.s;return bY<p.length(bW)&&(bX.c=p.get(bW,bY),bX.s=bY+1,true);},void 0);};_0.StringEnumerator=function(bW){return new _4.New(0,null,function(bX){var bY;bY=bX.s;return bY<bW.length&&(bX.c=bW[bY],bX.s=bY+1,true);},void 0);};_0.Get0=function(bW){return bW instanceof a.Array?_0.ArrayEnumerator(bW):e.Equals(typeof bW,"string")?_0.StringEnumerator(bW):"GetEnumerator0"in bW?bW.GetEnumerator0():bW.GetEnumerator();};_1.notPresent=function(){return k.FailWith("The given key was not present in the dictionary.");};_2=F.Scheduler=bT.Class({Fork:function(bW){var bX;bX=this;this.robin.push(bW);this.idle?(this.idle=false,a.setTimeout(function(){bX.tick();},0)):void 0;},tick:function(){var bW,bX,bY;bX=this;bY=bV.now();bW=true;while(bW)if(this.robin.length===0){this.idle=true;bW=false;}else{(this.robin.shift())();bV.now()-bY>40?(a.setTimeout(function(){bX.tick();},0),bW=false):void 0;}}},j,_2);_2.New=bT.Ctor(function(){j.New.call(this);this.idle=true;this.robin=[];},_2);_3=d.CancellationTokenSource=bT.Class({},j,_3);_3.New=bT.Ctor(function(){j.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},_3);L.MapSeqCached=function(bW,bX){return L.MapSeqCachedBy(a.id,bW,bX);};L.MapSeqCachedBy=function(bW,bX,bY){var bZ;bZ=[new C.New$5()];return L.Map(function(b0){var b1,b2,b3;b1=bZ[0];b2=new C.New$5();b3=bn.mapInPlace(function(b4){var b5,b6;b5=bW(b4);b6=b1.ContainsKey(b5)?b1.get_Item(b5):bX(b4);b2.set_Item(b5,b6);return b6;},p.ofSeq(b0));bZ[0]=b2;return b3;},bY);};L.Map=function(bW,bX){return L.CreateLazy(function(){return M.Map(bW,bX());});};L.Const=function(bW){var bX;bX=M.New({$:0,$0:bW});return function(){return bX;};};L.Sink=function(bW,bX){function bY(){M.WhenRun(bX(),bW,function(){F.scheduler().Fork(bY);});}F.scheduler().Fork(bY);};L.CreateLazy=function(bW){var bX;bX={c:null,o:bW};return function(){var bY,bZ;bY=bX.c;return bY===null?(bY=bX.o(),bX.c=bY,(bZ=bY.s,bZ!=null&&bZ.$==0)?bX.o=null:M.WhenObsoleteRun(bY,function(){bX.c=null;}),bY):bY;};};L.Bind=function(bW,bX){return L.Join(L.Map(bW,bX));};L.Map3=function(bW,bX,bY,bZ){return L.CreateLazy(function(){return M.Map3(bW,bX(),bY(),bZ());});};L.Sequence=function(bW){return L.CreateLazy(function(){return M.Sequence(x.map(function(bX){return bX();},bW));});};L.Map2=function(bW,bX,bY){return L.CreateLazy(function(){return M.Map2(bW,bX(),bY());});};L.Map2Unit=function(bW,bX){return L.CreateLazy(function(){return M.Map2Unit(bW(),bX());});};L.Join=function(bW){return L.CreateLazy(function(){return M.Join(bW());});};_4=_0.T=bT.Class({MoveNext:function(){return this.n(this);},Current:function(){return this.c;},Dispose:function(){if(this.d)this.d(this);}},j,_4);_4.New=bT.Ctor(function(bW,bX,bY,bZ){j.New.call(this);this.s=bW;this.c=bX;this.n=bY;this.d=bZ;},_4);_5=f.ConcreteVar=bT.Class({Set:function(bW){if(this.isConst)(function(bX){return bX("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(bX){bP.log(bX);}));else{M.Obsolete(this.snap);this.current=bW;this.snap=M.New({$:2,$0:bW,$1:[]});}},Get:function(){return this.current;},get_View:function(){return this.view;},UpdateMaybe:function(bW){var bX;bX=bW(this.Get());bX!=null&&bX.$==1?this.Set(bX.$0):void 0;}},s,_5);_5.New=bT.Ctor(function(bW,bX,bY){var bZ;bZ=this;s.New.call(this);this.isConst=bW;this.current=bY;this.snap=bX;this.view=function(){return bZ.snap;};this.id=bc.Int();},_5);_6.$cctor=function(){_6.$cctor=a.ignore;_6.LoadedTemplates=new C.New$5();_6.LocalTemplatesLoaded=false;_6.GlobalHoles=new C.New$5();_6.TextHoleRE="\\${([^}]+)}";_6.RenderedFullDocTemplate=null;};_8.LinkElement=function(bW,bX){_8.InsertDoc(bW,bX,null);};_8.InsertDoc=function(bW,bX,bY){var bZ,b0,b1;while(true)if(bX!=null&&bX.$==1)return _8.InsertNode(bW,bX.$0.El,bY);else if(bX!=null&&bX.$==2){bZ=bX.$0;bZ.Dirty=false;bX=bZ.Current;}else if(bX==null)return bY;else if(bX!=null&&bX.$==4)return _8.InsertNode(bW,bX.$0.Text,bY);else if(bX!=null&&bX.$==5)return _8.InsertNode(bW,bX.$0,bY);else if(bX!=null&&bX.$==6)return p.foldBack(function(b2,b3){return(((bT.Curried3(function(b4,b5,b6){return b5==null||b5.constructor===N?_8.InsertDoc(b4,b5,b6):_8.InsertNode(b4,b5,b6);}))(bW))(b2))(b3);},bX.$0.Els,bY);else{b0=bX.$1;b1=bX.$0;bX=b1;bY=_8.InsertDoc(bW,b0,bY);}};_8.CreateRunState=function(bW,bX){return bt.New(bu.get_Empty(),_8.CreateElemNode(bW,bo.EmptyAttr(),bX));};_8.PerformAnimatedUpdate=function(bW,bX,bY){var bZ;return bi.get_UseAnimations()?(bZ=null,F.Delay(function(){var b0,b1,b2;b0=bu.FindAll(bY);b1=_8.ComputeChangeAnim(bX,b0);b2=_8.ComputeEnterAnim(bX,b0);return F.Bind(bi.Play(bi.Append(b1,_8.ComputeExitAnim(bX,b0))),function(){return F.Bind(_8.SyncElemNodesNextFrame(bW,bX),function(){return F.Bind(bi.Play(b2),function(){bX.PreviousNodes=b0;return F.Return(null);});});});})):_8.SyncElemNodesNextFrame(bW,bX);};_8.PerformSyncUpdate=function(bW,bX,bY){var bZ;bZ=bu.FindAll(bY);_8.SyncElemNode(bW,bX.Top);bX.PreviousNodes=bZ;};_8.CreateEmbedNode=function(){return{Current:null,Dirty:false};};_8.UpdateEmbedNode=function(bW,bX){bW.Current=bX;bW.Dirty=true;};_8.InsertBeforeDelim=function(bW,bX){var bY,bZ;bY=bW.parentNode;bZ=self.document.createTextNode("");bY.insertBefore(bZ,bW);_8.LinkPrevElement(bW,bX);return bZ;};_8.InsertNode=function(bW,bX,bY){bg.InsertAt(bW,bY,bX);return bX;};_8.CreateElemNode=function(bW,bX,bY){var bZ;_8.LinkElement(bW,bY);bZ=bo.Insert(bW,bX);return _9.New(bZ,bY,null,bW,bc.Int(),bT.GetOptional(bZ.OnAfterRender));};_8.SyncElemNodesNextFrame=function(bW,bX){function bY(bZ){a.requestAnimationFrame(function(){_8.SyncElemNode(bW,bX.Top);bZ();});}return bj.BatchUpdatesEnabled()?F.FromContinuations(function(bZ,b0,b1){return bY.apply(null,[bZ,b0,b1]);}):(_8.SyncElemNode(bW,bX.Top),F.Return(null));};_8.ComputeExitAnim=function(bW,bX){return bi.Concat(p.map(function(bY){return bo.GetExitAnim(bY.Attr);},bu.ToArray(bu.Except(bX,bu.Filter(function(bY){return bo.HasExitAnim(bY.Attr);},bW.PreviousNodes)))));};_8.ComputeEnterAnim=function(bW,bX){return bi.Concat(p.map(function(bY){return bo.GetEnterAnim(bY.Attr);},bu.ToArray(bu.Except(bW.PreviousNodes,bu.Filter(function(bY){return bo.HasEnterAnim(bY.Attr);},bX)))));};_8.ComputeChangeAnim=function(bW,bX){var bY;function bZ(b0){return bo.HasChangeAnim(b0.Attr);}bY=function(b0){return bu.Filter(bZ,b0);};return bi.Concat(p.map(function(b0){return bo.GetChangeAnim(b0.Attr);},bu.ToArray(bu.Intersect(bY(bW.PreviousNodes),bY(bX)))));};_8.SyncElemNode=function(bW,bX){!bW?_8.SyncElement(bX):void 0;_8.Sync(bX.Children);_8.AfterRender(bX);};_8.CreateTextNode=function(){return{Text:self.document.createTextNode(""),Dirty:false,Value:""};};_8.UpdateTextNode=function(bW,bX){bW.Value=bX;bW.Dirty=true;};_8.LinkPrevElement=function(bW,bX){_8.InsertDoc(bW.parentNode,bX,bW);};_8.SyncElement=function(bW){function bX(bY){function bZ(b0){var b1,b2,b3,b4;while(true){if(b0!=null&&b0.$==0){b2=b0.$1;b3=b0.$0;if(bZ(b3))return true;else b0=b2;}else if(b0!=null&&b0.$==2){b4=b0.$0;if(b4.Dirty)return true;else b0=b4.Current;}else return b0!=null&&b0.$==6&&(b1=b0.$0,b1.Dirty||p.exists(bX,b1.Holes));}}return bZ(bY.Children);}bo.Sync(bW.El,bW.Attr);bX(bW)?_8.DoSyncElement(bW):void 0;};_8.Sync=function(bW){var bX,bY,bZ,b0,b1;while(true){if(bW!=null&&bW.$==1)return _8.SyncElemNode(false,bW.$0);else if(bW!=null&&bW.$==2){bZ=bW.$0;bW=bZ.Current;}else if(bW==null)return null;else if(bW!=null&&bW.$==5)return null;else if(bW!=null&&bW.$==4){bX=bW.$0;return bX.Dirty?(bX.Text.nodeValue=bX.Value,bX.Dirty=false):null;}else if(bW!=null&&bW.$==6){bY=bW.$0;p.iter(function(b2){return function(b3){_8.SyncElemNode(b2,b3);};}(false),bY.Holes);p.iter(function(b2){bo.Sync(b2[0],b2[1]);},bY.Attrs);return _8.AfterRender(bY);}else{b0=bW.$1;b1=bW.$0;_8.Sync(b1);bW=b0;}}};_8.AfterRender=function(bW){var bX;bX=bT.GetOptional(bW.Render);bX!=null&&bX.$==1?(bX.$0(bW.El),bT.SetOptional(bW,"Render",null)):void 0;};_8.DoSyncElement=function(bW){var bX,bY,bZ;function b0(b1,b2){var b3,b4,b5,b6;while(true){if(b1!=null&&b1.$==1)return b1.$0.El;else if(b1!=null&&b1.$==2){b4=b1.$0;if(b4.Dirty){b4.Dirty=false;return _8.InsertDoc(bX,b4.Current,b2);}else b1=b4.Current;}else if(b1==null)return b2;else if(b1!=null&&b1.$==4)return b1.$0.Text;else if(b1!=null&&b1.$==5)return b1.$0;else if(b1!=null&&b1.$==6){b3=b1.$0;b3.Dirty?b3.Dirty=false:void 0;return p.foldBack(function(b7,b8){return b7==null||b7.constructor===N?b0(b7,b8):b7;},b3.Els,b2);}else{b5=b1.$1;b6=b1.$0;b1=b6;b2=b0(b5,b2);}}}bX=bW.El;bI.Iter((bY=bW.El,function(b1){bg.RemoveNode(bY,b1);}),bI.Except(bI.DocChildren(bW),bI.Children(bW.El,bT.GetOptional(bW.Delimiters))));b0(bW.Children,(bZ=bT.GetOptional(bW.Delimiters),bZ!=null&&bZ.$==1?bZ.$0[1]:null));};_9=f.DocElemNode=bT.Class({Equals:function(bW){return this.ElKey===bW.ElKey;},GetHashCode:function(){return this.ElKey;}},null,_9);_9.New=function(bW,bX,bY,bZ,b0,b1){var b2;return new _9((b2={Attr:bW,Children:bX,El:bZ,ElKey:b0},(bT.SetOptional(b2,"Delimiters",bY),bT.SetOptional(b2,"Render",b1),b2)));};ba=d.OperationCanceledException=bT.Class({},$,ba);ba.New=bT.Ctor(function(bW){ba.New$1.call(this,"The operation was canceled.",null,bW);},ba);ba.New$1=bT.Ctor(function(bW,bX,bY){this.message=bW;this.inner=bX;N.setPrototypeOf(this,ba.prototype);this.ct=bY;},ba);bc.Int=function(){bc.set_counter(bc.counter()+1);return bc.counter();};bc.set_counter=function(bW){by.$cctor();by.counter=bW;};bc.counter=function(){by.$cctor();return by.counter;};bd=f.Elt=bT.Class({},J,bd);bd.TreeNode=function(bW,bX){var bY,bZ;function b0(b1){return b1[1];}bY=bq.Create(bX);return new bd.New$1({$:6,$0:bW},L.Map2Unit((bZ=p.map(function(b1){return bo.Updates(b0(b1));},bW.Attrs),bn.TreeReduce(L.Const(),L.Map2Unit,bZ)),bY.v),p.get(bW.Els,0),bY);};bd.New$1=bT.Ctor(function(bW,bX,bY,bZ){J.New.call(this,bW,bX);this.docNode$1=bW;this.updates$1=bX;this.elt=bY;this.rvUpdates=bZ;},bd);be.convertTextNode=function(bW){var bX,bY,bZ,b0,b1,b2;bX=null;bY=0;b0=bW.textContent;b1=new a.RegExp(I.TextHoleRE(),"g");while(bX=b1.exec(b0),bX!==null){bW.parentNode.insertBefore(self.document.createTextNode(bf.string(b0,{$:1,$0:bY},{$:1,$0:b1.lastIndex-p.get(bX,0).length-1})),bW);bY=b1.lastIndex;b2=self.document.createElement("span");b2.setAttribute("ws-replace",p.get(bX,1).toLowerCase());bW.parentNode.insertBefore(b2,bW);}b1.lastIndex=0;bW.textContent=bf.string(b0,{$:1,$0:bY},null);};be.failNotLoaded=function(bW){bP.warn("Instantiating non-loaded template",bW);};be.fillTextHole=function(bW,bX,bY){var bZ;bZ=bW.querySelector("[ws-replace]");return e.Equals(bZ,null)?(bP.warn("Filling non-existent text hole",bY),null):(bZ.parentNode.replaceChild(self.document.createTextNode(bX),bZ),{$:1,$0:bZ.getAttribute("ws-replace")});};be.removeHolesExcept=function(bW,bX){function bY(bZ){I.foreachNotPreserved(bW,"["+bZ+"]",function(b0){if(!bX.Contains(b0.getAttribute(bZ)))b0.removeAttribute(bZ);});}bY("ws-attr");bY("ws-onafterrender");bY("ws-var");I.foreachNotPreserved(bW,"[ws-hole]",function(bZ){if(!bX.Contains(bZ.getAttribute("ws-hole"))){bZ.removeAttribute("ws-hole");while(bZ.hasChildNodes())bZ.removeChild(bZ.lastChild);}});I.foreachNotPreserved(bW,"[ws-replace]",function(bZ){if(!bX.Contains(bZ.getAttribute("ws-replace")))bZ.parentNode.removeChild(bZ);});I.foreachNotPreserved(bW,"[ws-on]",function(bZ){bZ.setAttribute("ws-on",G.concat(" ",p.filter(function(b0){return bX.Contains(p.get(G.SplitChars(b0,[":"],1),1));},G.SplitChars(bZ.getAttribute("ws-on"),[" "],1))));});I.foreachNotPreserved(bW,"[ws-attr-holes]",function(bZ){var b0,b1,b2,b3,b4;b0=G.SplitChars(bZ.getAttribute("ws-attr-holes"),[" "],1);for(b1=0,b2=b0.length-1;b1<=b2;b1++){b3=p.get(b0,b1);bZ.setAttribute(b3,(b4=new a.RegExp(I.TextHoleRE(),"g"),bZ.getAttribute(b3).replace(b4,function(b5,b6){return bX.Contains(b6)?b5:"";})));}});};be.fillInstanceAttrs=function(bW,bX){var bY,bZ,b0,b1,b2;be.convertAttrs(bX);bY=bX.nodeName.toLowerCase();bZ=bW.querySelector("[ws-attr="+bY+"]");if(e.Equals(bZ,null))bP.warn("Filling non-existent attr hole",bY);else{bZ.removeAttribute("ws-attr");for(b0=0,b1=bX.attributes.length-1;b0<=b1;b0++){b2=bX.attributes.item(b0);b2.name==="class"&&bZ.hasAttribute("class")?bZ.setAttribute("class",bZ.getAttribute("class")+" "+b2.nodeValue):bZ.setAttribute(b2.name,b2.nodeValue);}}};be.mapHoles=function(bW,bX){function bY(bZ){I.foreachNotPreserved(bW,"["+bZ+"]",function(b0){var b1,b2;b1=(b2=null,[bX.TryGetValue(b0.getAttribute(bZ).toLowerCase(),{get:function(){return b2;},set:function(b3){b2=b3;}}),b2]);b1[0]?b0.setAttribute(bZ,b1[1]):void 0;});}bY("ws-hole");bY("ws-replace");bY("ws-attr");bY("ws-onafterrender");bY("ws-var");I.foreachNotPreserved(bW,"[ws-on]",function(bZ){bZ.setAttribute("ws-on",G.concat(" ",p.map(function(b0){var b1,b2,b3;b1=G.SplitChars(b0,[":"],1);b2=(b3=null,[bX.TryGetValue(p.get(b1,1),{get:function(){return b3;},set:function(b4){b3=b4;}}),b3]);return b2[0]?p.get(b1,0)+":"+b2[1]:b0;},G.SplitChars(bZ.getAttribute("ws-on"),[" "],1))));});I.foreachNotPreserved(bW,"[ws-attr-holes]",function(bZ){var b0,b1,b2;b0=G.SplitChars(bZ.getAttribute("ws-attr-holes"),[" "],1);for(b1=0,b2=b0.length-1;b1<=b2;b1++)(function(){var b3;function b4(b5,b6){var b7;b7=k.KeyValue(b6);return b5.replace(new a.RegExp("\\${"+b7[0]+"}","ig"),"${"+b7[1]+"}");}b3=p.get(b0,b1);return bZ.setAttribute(b3,(((bT.Curried3(x.fold))(b4))(bZ.getAttribute(b3)))(bX));}());});};be.fill=function(bW,bX,bY){while(true)if(bW.hasChildNodes())bY=bX.insertBefore(bW.lastChild,bY);else return null;};be.convertAttrs=function(bW){var bY,bZ,b0,b1,b2,b3,b4,b5;function bX(b6){var b7;b7=bW.getAttribute(b6);b7===null?void 0:bW.setAttribute(b6,b7.toLowerCase());}bY=bW.attributes;bZ=[];b0=[];b1=[];for(b2=0,b3=bY.length-1;b2<=b3;b2++){b4=bY.item(b2);G.StartsWith(b4.nodeName,"ws-on")&&b4.nodeName!=="ws-onafterrender"&&b4.nodeName!=="ws-on"?(bZ.push(b4.nodeName),b0.push(bf.string(b4.nodeName,{$:1,$0:"ws-on".length},null)+":"+b4.nodeValue.toLowerCase())):!G.StartsWith(b4.nodeName,"ws-")&&(new a.RegExp(I.TextHoleRE())).test(b4.nodeValue)?(b4.nodeValue=(b5=new a.RegExp(I.TextHoleRE(),"g"),b4.nodeValue.replace(b5,function(b6,b7){return"${"+b7.toLowerCase()+"}";})),b1.push(b4.nodeName)):void 0;}!(b0.length==0)?bW.setAttribute("ws-on",G.concat(" ",b0)):void 0;!(b1.length==0)?bW.setAttribute("ws-attr-holes",G.concat(" ",b1)):void 0;bX("ws-hole");bX("ws-replace");bX("ws-attr");bX("ws-onafterrender");bX("ws-var");p.iter(function(b6){bW.removeAttribute(b6);},bZ);};bf.string=function(bW,bX,bY){return bX==null?bY!=null&&bY.$==1?bW.slice(0,bY.$0+1):"":bY==null?bW.slice(bX.$0):bW.slice(bX.$0,bY.$0+1);};bg.ParseHTMLIntoFakeRoot=function(bW){var bX,bY,bZ,b0,b1;function b2(b3,b4){var b5;while(true)if(b4===0)return b3;else{b5=b4;b3=b3.lastChild;b4=b5-1;}}bX=self.document.createElement("div");return!bg.rhtml().test(bW)?(bX.appendChild(self.document.createTextNode(bW)),bX):(bY=(bZ=bg.rtagName().exec(bW),e.Equals(bZ,null)?"":p.get(bZ,1).toLowerCase()),(b0=(b1=(bg.wrapMap())[bY],b1?b1:bg.defaultWrap()),(bX.innerHTML=b0[1]+bW.replace(bg.rxhtmlTag(),"<$1></$2>")+b0[2],b2(bX,b0[0]))));};bg.ChildrenArray=function(bW){var bX,bY,bZ;bX=[];for(bY=0,bZ=bW.childNodes.length-1;bY<=bZ;bY++)bX.push(bW.childNodes[bY]);return bX;};bg.rhtml=function(){bA.$cctor();return bA.rhtml;};bg.wrapMap=function(){bA.$cctor();return bA.wrapMap;};bg.defaultWrap=function(){bA.$cctor();return bA.defaultWrap;};bg.rxhtmlTag=function(){bA.$cctor();return bA.rxhtmlTag;};bg.rtagName=function(){bA.$cctor();return bA.rtagName;};bg.IterSelector=function(bW,bX,bY){var bZ,b0,b1;bZ=bW.querySelectorAll(bX);for(b0=0,b1=bZ.length-1;b0<=b1;b0++)bY(bZ[b0]);};bg.InsertAt=function(bW,bX,bY){var bZ;if(!(bY.parentNode===bW&&bX===(bZ=bY.nextSibling,e.Equals(bZ,null)?null:bZ)))bW.insertBefore(bY,bX);};bg.RemoveNode=function(bW,bX){if(bX.parentNode===bW)bW.removeChild(bX);};x.insufficient=function(){return k.FailWith("The input sequence has an insufficient number of elements.");};bh=A.KeyCollection=bT.Class({GetEnumerator$1:function(){return _0.Get(x.map(function(bW){return bW.K;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},j,bh);bh.New=bT.Ctor(function(bW){j.New.call(this);this.d=bW;},bh);bi.get_UseAnimations=function(){return bv.UseAnimations();};bi.Play=function(bW){var bX;bX=null;return F.Delay(function(){return F.Bind(bi.Run(a.ignore,bv.Actions(bW)),function(){bv.Finalize(bW);return F.Return(null);});});};bi.Append=function(bW,bX){return{$:0,$0:bC.Append(bW.$0,bX.$0)};};bi.Run=function(bW,bX){var bY;function bZ(b0){function b1(b2){return function(b3){var b4;b4=b3-b2;bX.Compute(b4);bW();return b4<=bY?void a.requestAnimationFrame(function(b5){(b1(b2))(b5);}):b0();};}a.requestAnimationFrame(function(b2){(b1(b2))(b2);});}bY=bX.Duration;return bY===0?F.Zero():F.FromContinuations(function(b0,b1,b2){return bZ.apply(null,[b0,b1,b2]);});};bi.Concat=function(bW){return{$:0,$0:bC.Concat(x.map(bv.List,bW))};};bi.get_Empty=function(){return{$:0,$0:bC.Empty()};};bj.BatchUpdatesEnabled=function(){bw.$cctor();return bw.BatchUpdatesEnabled;};bk.StartProcessor=function(bW){var bX;function bY(){var bZ;bZ=null;return F.Delay(function(){return F.Bind(bW,function(){var b0;b0=bX[0];return b0===1?(bX[0]=0,F.Zero()):b0===2?(bX[0]=1,bY()):F.Zero();});});}bX=[0];return function(){var bZ;bZ=bX[0];bZ===0?(bX[0]=1,F.Start(bY(),null)):bZ===1?bX[0]=2:void 0;};};bm.New=function(bW,bX,bY,bZ){var b0;b0={DynElem:bW,DynFlags:bX,DynNodes:bY};bT.SetOptional(b0,"OnAfterRender",bZ);return b0;};bn.mapInPlace=function(bW,bX){var bY,bZ;for(bY=0,bZ=bX.length-1;bY<=bZ;bY++)bX[bY]=bW(bX[bY]);return bX;};bn.ofSeqNonCopying=function(bW){var bX,bY;if(bW instanceof a.Array)return bW;else if(bW instanceof i)return p.ofList(bW);else if(bW===null)return[];else{bX=[];bY=_0.Get(bW);try{while(bY.MoveNext())bX.push(bY.Current());return bX;}finally{if(typeof bY=="object"&&"Dispose"in bY)bY.Dispose();}}};bn.TreeReduce=function(bW,bX,bY){var bZ;function b0(b1){return function(b2){var b3,b4;return b2<=0?bW:b2===1&&(b1>=0&&b1<bZ)?p.get(bY,b1):(b4=b2/2>>0,bX((b0(b1))(b4),(b0(b1+b4))(b2-b4)));};}bZ=p.length(bY);return(b0(0))(bZ);};bn.MapTreeReduce=function(bW,bX,bY,bZ){var b0;function b1(b2){return function(b3){var b4,b5;return b3<=0?bX:b3===1&&(b2>=0&&b2<b0)?bW(p.get(bZ,b2)):(b5=b3/2>>0,bY((b1(b2))(b5),(b1(b2+b5))(b3-b5)));};}b0=p.length(bZ);return(b1(0))(b0);};bo.Insert=function(bW,bX){var bY,bZ,b0;function b1(b2){var b3,b4;while(true)if(!(b2===null)){if(b2!=null&&b2.$==1)return bY.push(b2.$0);else if(b2!=null&&b2.$==2){b3=b2.$1;b4=b2.$0;b1(b4);b2=b3;}else return b2!=null&&b2.$==3?b2.$0(bW):b2!=null&&b2.$==4?bZ.push(b2.$0):null;}else return null;}bY=[];bZ=[];b1(bX);b0=bY.slice(0);return bm.New(bW,bo.Flags(bX),b0,bZ.length===0?null:{$:1,$0:function(b2){x.iter(function(b3){b3(b2);},bZ);}});};bo.Updates=function(bW){return bn.MapTreeReduce(function(bX){return bX.NChanged();},L.Const(),L.Map2Unit,bW.DynNodes);};bo.Empty=function(bW){return bm.New(bW,0,[],null);};bo.Flags=function(bW){return bW!==null&&bW.hasOwnProperty("flags")?bW.flags:0;};bo.Static=function(bW){return new O({$:3,$0:bW});};bo.Dynamic=function(bW,bX){return new O({$:1,$0:new bE.New(bW,bX)});};bo.EmptyAttr=function(){bD.$cctor();return bD.EmptyAttr;};bo.HasExitAnim=function(bW){var bX;bX=2;return(bW.DynFlags&bX)===bX;};bo.GetExitAnim=function(bW){return bo.GetAnim(bW,function(bX,bY){return bX.NGetExitAnim(bY);});};bo.HasEnterAnim=function(bW){var bX;bX=1;return(bW.DynFlags&bX)===bX;};bo.GetEnterAnim=function(bW){return bo.GetAnim(bW,function(bX,bY){return bX.NGetEnterAnim(bY);});};bo.HasChangeAnim=function(bW){var bX;bX=4;return(bW.DynFlags&bX)===bX;};bo.GetChangeAnim=function(bW){return bo.GetAnim(bW,function(bX,bY){return bX.NGetChangeAnim(bY);});};bo.AppendTree=function(bW,bX){var bY;return bW===null?bX:bX===null?bW:(bY=new O({$:2,$0:bW,$1:bX}),(bo.SetFlags(bY,bo.Flags(bW)|bo.Flags(bX)),bY));};bo.GetAnim=function(bW,bX){return bi.Concat(p.map(function(bY){return bX(bY,bW.DynElem);},bW.DynNodes));};bo.Sync=function(bW,bX){p.iter(function(bY){bY.NSync(bW);},bX.DynNodes);};bo.SetFlags=function(bW,bX){bW.flags=bX;};bp.Handler=function(bW,bX){return bo.Static(function(bY){bY.addEventListener(bW,function(bZ){return(bX(bY))(bZ);},false);});};bp.OnAfterRender=function(bW){return new O({$:4,$0:bW});};bp.Value=function(bW){var bX;bX=(((bz.StringApply())(bW))(bo.Static))(function(bY){return bp.DynamicCustom(bY,bW.get_View());});return O.Append(bX[0],bX[1]);};bp.Checked=function(bW){var bX;bX=(((bz.BoolCheckedApply())(bW))(bo.Static))(function(bY){return bp.DynamicCustom(bY,bW.get_View());});return O.Append(bX[0],bX[1]);};bp.IntValue=function(bW){var bX;bX=(((bz.IntApplyChecked())(bW))(bo.Static))(function(bY){return bp.DynamicCustom(bY,bW.get_View());});return O.Append(bX[0],bX[1]);};bp.IntValueUnchecked=function(bW){var bX;bX=(((bz.IntApplyUnchecked())(bW))(bo.Static))(function(bY){return bp.DynamicCustom(bY,bW.get_View());});return O.Append(bX[0],bX[1]);};bp.FloatValue=function(bW){var bX;bX=(((bz.FloatApplyChecked())(bW))(bo.Static))(function(bY){return bp.DynamicCustom(bY,bW.get_View());});return O.Append(bX[0],bX[1]);};bp.FloatValueUnchecked=function(bW){var bX;bX=(((bz.FloatApplyUnchecked())(bW))(bo.Static))(function(bY){return bp.DynamicCustom(bY,bW.get_View());});return O.Append(bX[0],bX[1]);};bp.Dynamic=function(bW,bX){return bo.Dynamic(bX,function(bY){return function(bZ){return bY.setAttribute(bW,bZ);};});};bp.DynamicCustom=function(bW,bX){return bo.Dynamic(bX,bW);};bq=f.Updates=bT.Class({},null,bq);bq.Create=function(bW){var bX;bX=null;bX=bq.New(bW,null,function(){var bY;bY=bX.s;return bY===null?(bY=M.Copy(bX.c()),bX.s=bY,M.WhenObsoleteRun(bY,function(){bX.s=null;}),bY):bY;});return bX;};bq.New=function(bW,bX,bY){return new bq({c:bW,s:bX,v:bY});};br=A.ValueCollection=bT.Class({GetEnumerator$1:function(){return _0.Get(x.map(function(bW){return bW.V;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},j,br);br.New=bT.Ctor(function(bW){j.New.call(this);this.d=bW;},br);bt.New=function(bW,bX){return{PreviousNodes:bW,Top:bX};};bu.get_Empty=function(){return{$:0,$0:new U.New$3()};};bu.FindAll=function(bW){var bX;function bY(b1,b2){var b3,b4,b5,b6,b7;while(true)switch(b1){case 0:if(b2!=null&&b2.$==0){b4=b2.$1;b5=b2.$0;bY(0,b5);b2=b4;}else if(b2!=null&&b2.$==1){b6=b2.$0;b2=b6;b1=1;}else if(b2!=null&&b2.$==2){b7=b2.$0;b2=b7.Current;}else return b2!=null&&b2.$==6?(b3=b2.$0.Holes,(function(b8){return function(b9){p.iter(b8,b9);};}(b0))(b3)):null;break;case 1:bX.push(b2);b2=b2.Children;b1=0;break;}}function bZ(b1){return bY(0,b1);}function b0(b1){return bY(1,b1);}bX=[];bZ(bW);return{$:0,$0:new U.New$2(bX)};};bu.Filter=function(bW,bX){return{$:0,$0:bG.Filter(bW,bX.$0)};};bu.Except=function(bW,bX){return{$:0,$0:bG.Except(bW.$0,bX.$0)};};bu.ToArray=function(bW){return bG.ToArray(bW.$0);};bu.Intersect=function(bW,bX){return{$:0,$0:bG.Intersect(bW.$0,bX.$0)};};bv.UseAnimations=function(){bB.$cctor();return bB.UseAnimations;};bv.Actions=function(bW){return bv.ConcatActions(p.choose(function(bX){return bX.$==1?{$:1,$0:bX.$0}:null;},bC.ToArray(bW.$0)));};bv.Finalize=function(bW){p.iter(function(bX){if(bX.$==0)bX.$0();},bC.ToArray(bW.$0));};bv.ConcatActions=function(bW){var bX,bY,bZ,b0;bX=bn.ofSeqNonCopying(bW);bY=p.length(bX);return bY===0?bv.Const():bY===1?p.get(bX,0):(bZ=x.max(x.map(function(b1){return b1.Duration;},bX)),(b0=p.map(function(b1){return bv.Prolong(bZ,b1);},bX),bv.Def(bZ,function(b1){p.iter(function(b2){b2.Compute(b1);},b0);})));};bv.List=function(bW){return bW.$0;};bv.Const=function(bW){return bv.Def(0,function(){return bW;});};bv.Def=function(bW,bX){return{Compute:bX,Duration:bW};};bv.Prolong=function(bW,bX){var bY,bZ,b0;bY=bX.Compute;bZ=bX.Duration;b0=bL.Create(function(){return bX.Compute(bX.Duration);});return{Compute:function(b1){return b1>=bZ?b0.f():bY(b1);},Duration:bW};};bw.$cctor=function(){bw.$cctor=a.ignore;bw.BatchUpdatesEnabled=true;};bx.concat=function(bW){var bX,bY;bX=[];for(var bZ in bW)bX.push.apply(bX,bW[bZ]);return bX;};by.$cctor=function(){by.$cctor=a.ignore;by.counter=0;};bz.StringApply=function(){bD.$cctor();return bD.StringApply;};bz.BoolCheckedApply=function(){bD.$cctor();return bD.BoolCheckedApply;};bz.IntApplyChecked=function(){bD.$cctor();return bD.IntApplyChecked;};bz.IntApplyUnchecked=function(){bD.$cctor();return bD.IntApplyUnchecked;};bz.FloatApplyChecked=function(){bD.$cctor();return bD.FloatApplyChecked;};bz.FloatApplyUnchecked=function(){bD.$cctor();return bD.FloatApplyUnchecked;};bz.ApplyValue=function(bW,bX,bY,bZ,b0){return[bZ(function(b1){function b2(){bY.UpdateMaybe(function(b3){var b4,b5;b4=bW(b1);return b4!=null&&b4.$==1&&(!e.Equals(b4.$0,b3)&&(b5=[b4,b4.$0],true))?b5[0]:null;});}b1.addEventListener("change",b2);b1.addEventListener("input",b2);b1.addEventListener("keypress",b2);}),b0(function(b1){return function(b2){var b3,b4;b3=bW(b1);return b3!=null&&b3.$==1&&(e.Equals(b3.$0,b2)&&(b4=b3.$0,true))?null:bX(b1,b2);};})];};bz.StringSet=function(){bD.$cctor();return bD.StringSet;};bz.StringGet=function(){bD.$cctor();return bD.StringGet;};bz.IntSetUnchecked=function(){bD.$cctor();return bD.IntSetUnchecked;};bz.IntGetUnchecked=function(){bD.$cctor();return bD.IntGetUnchecked;};bz.IntSetChecked=function(){bD.$cctor();return bD.IntSetChecked;};bz.IntGetChecked=function(){bD.$cctor();return bD.IntGetChecked;};bz.FloatSetUnchecked=function(){bD.$cctor();return bD.FloatSetUnchecked;};bz.FloatGetUnchecked=function(){bD.$cctor();return bD.FloatGetUnchecked;};bz.FloatSetChecked=function(){bD.$cctor();return bD.FloatSetChecked;};bz.FloatGetChecked=function(){bD.$cctor();return bD.FloatGetChecked;};bA.$cctor=function(){var bW;bA.$cctor=a.ignore;bA.rxhtmlTag=new a.RegExp("<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>","gi");bA.rtagName=new a.RegExp("<([\\w:]+)");bA.rhtml=new a.RegExp("<|&#?\\w+;");bA.wrapMap=(bW=[1,"<table>","</table>"],{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:bW,tbody:bW,tfoot:bW,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><colgroup>","</colgoup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"]});bA.defaultWrap=[0,"",""];};bB.$cctor=function(){bB.$cctor=a.ignore;bB.CubicInOut=bF.Custom(function(bW){var bX;bX=bW*bW;return 3*bX-2*(bX*bW);});bB.UseAnimations=true;};bC.Append=function(bW,bX){return bW.$==0?bX:bX.$==0?bW:{$:2,$0:bW,$1:bX};};bC.ToArray=function(bW){var bX;function bY(bZ){var b0,b1;while(true)if(bZ.$==1)return bX.push(bZ.$0);else if(bZ.$==2){b0=bZ.$1;b1=bZ.$0;bY(b1);bZ=b0;}else return bZ.$==3?p.iter(function(b2){bX.push(b2);},bZ.$0):null;}bX=[];bY(bW);return bX.slice(0);};bC.Concat=function(bW){var bX;bX=bn.ofSeqNonCopying(bW);return bn.TreeReduce(bC.Empty(),bC.Append,bX);};bC.Empty=function(){bM.$cctor();return bM.Empty;};bD.$cctor=function(){var bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5;bD.$cctor=a.ignore;bD.EmptyAttr=null;bD.BoolCheckedApply=bT.Curried3(function(b6,b7,b8){return[b7(function(b9){b9.addEventListener("change",function(){return!e.Equals(b6.Get(),b9.checked)?b6.Set(b9.checked):null;});}),b8(function(b9){return function(b_){b9.checked=b_;};})];});bD.StringSet=function(b6){return function(b7){b6.value=b7;};};bD.StringGet=function(b6){return{$:1,$0:b6.value};};bD.StringApply=(bW=bz.StringGet(),(bX=bz.StringSet(),bT.Curried(bz.ApplyValue,3,[bW,function(b6,b7){return(bX(b6))(b7);}])));bD.IntSetUnchecked=function(b6){return function(b7){b6.value=a.String(b7);};};bD.IntGetUnchecked=function(b6){var b7,b8;b7=b6.value;return bH.isBlank(b7)?{$:1,$0:0}:(b8=+b7,b8!==b8>>0?null:{$:1,$0:b8});};bD.IntApplyUnchecked=(bY=bz.IntGetUnchecked(),(bZ=bz.IntSetUnchecked(),bT.Curried(bz.ApplyValue,3,[bY,function(b6,b7){return(bZ(b6))(b7);}])));bD.IntSetChecked=function(b6){return function(b7){var b8;b8=b7.get_Input();return b6.value!==b8?void(b6.value=b8):null;};};bD.IntGetChecked=function(b6){var b7,b8,b9;b7=b6.value;return{$:1,$0:bH.isBlank(b7)?(b6.checkValidity?b6.checkValidity():true)?new P({$:2,$0:b7}):new P({$:1,$0:b7}):(b8=(b9=0,[Q.TryParseInt32(b7,{get:function(){return b9;},set:function(b_){b9=b_;}}),b9]),b8[0]?new P({$:0,$0:b8[1],$1:b7}):new P({$:1,$0:b7}))};};bD.IntApplyChecked=(b0=bz.IntGetChecked(),(b1=bz.IntSetChecked(),bT.Curried(bz.ApplyValue,3,[b0,function(b6,b7){return(b1(b6))(b7);}])));bD.FloatSetUnchecked=function(b6){return function(b7){b6.value=a.String(b7);};};bD.FloatGetUnchecked=function(b6){var b7,b8;b7=b6.value;return bH.isBlank(b7)?{$:1,$0:0}:(b8=+b7,a.isNaN(b8)?null:{$:1,$0:b8});};bD.FloatApplyUnchecked=(b2=bz.FloatGetUnchecked(),(b3=bz.FloatSetUnchecked(),bT.Curried(bz.ApplyValue,3,[b2,function(b6,b7){return(b3(b6))(b7);}])));bD.FloatSetChecked=function(b6){return function(b7){var b8;b8=b7.get_Input();return b6.value!==b8?void(b6.value=b8):null;};};bD.FloatGetChecked=function(b6){var b7,b8;b7=b6.value;return{$:1,$0:bH.isBlank(b7)?(b6.checkValidity?b6.checkValidity():true)?new P({$:2,$0:b7}):new P({$:1,$0:b7}):(b8=+b7,a.isNaN(b8)?new P({$:1,$0:b7}):new P({$:0,$0:b8,$1:b7}))};};bD.FloatApplyChecked=(b4=bz.FloatGetChecked(),(b5=bz.FloatSetChecked(),bT.Curried(bz.ApplyValue,3,[b4,function(b6,b7){return(b5(b6))(b7);}])));};bE=f.DynamicAttrNode=bT.Class({NChanged:function(){return this.updates;},NGetExitAnim:function(bW){return bi.get_Empty();},NGetEnterAnim:function(bW){return bi.get_Empty();},NGetChangeAnim:function(bW){return bi.get_Empty();},NSync:function(bW){if(this.dirty){(this.push(bW))(this.value);this.dirty=false;}}},j,bE);bE.New=bT.Ctor(function(bW,bX){var bY;bY=this;j.New.call(this);this.push=bX;this.value=void 0;this.dirty=false;this.updates=L.Map(function(bZ){bY.value=bZ;bY.dirty=true;},bW);},bE);bF=f.Easing=bT.Class({},j,bF);bF.Custom=function(bW){return new bF.New(bW);};bF.New=bT.Ctor(function(bW){j.New.call(this);this.transformTime=bW;},bF);bG.Filter=function(bW,bX){return new U.New$2(p.filter(bW,bG.ToArray(bX)));};bG.Except=function(bW,bX){var bY;bY=new U.New$2(bG.ToArray(bX));bY.ExceptWith(bG.ToArray(bW));return bY;};bG.ToArray=function(bW){var bX;bX=p.create(bW.get_Count(),void 0);bW.CopyTo(bX);return bX;};bG.Intersect=function(bW,bX){var bY;bY=new U.New$2(bG.ToArray(bW));bY.IntersectWith(bG.ToArray(bX));return bY;};bH.isBlank=function(bW){return G.forall(bK.IsWhiteSpace,bW);};bI.Children=function(bW,bX){var bY,bZ,b0;if(bX!=null&&bX.$==1){b0=[];bY=bX.$0[0].nextSibling;while(bY!==bX.$0[1]){b0.push(bY);bY=bY.nextSibling;}return{$:0,$0:b0};}else return{$:0,$0:p.init(bW.childNodes.length,(bZ=bW.childNodes,function(b1){return bZ[b1];}))};};bI.Except=function(bW,bX){var bY;bY=bW.$0;return{$:0,$0:p.filter(function(bZ){return p.forall(function(b0){return!(bZ===b0);},bY);},bX.$0)};};bI.Iter=function(bW,bX){p.iter(bW,bX.$0);};bI.DocChildren=function(bW){var bX;function bY(bZ){var b0,b1,b2,b3;while(true){if(bZ!=null&&bZ.$==2){b1=bZ.$0;bZ=b1.Current;}else if(bZ!=null&&bZ.$==1)return bX.push(bZ.$0.El);else if(bZ==null)return null;else if(bZ!=null&&bZ.$==5)return bX.push(bZ.$0);else if(bZ!=null&&bZ.$==4)return bX.push(bZ.$0.Text);else if(bZ!=null&&bZ.$==6){b0=bZ.$0.Els;return(function(b4){return function(b5){p.iter(b4,b5);};}(function(b4){if(b4==null||b4.constructor===N)bY(b4);else bX.push(b4);}))(b0);}else{b2=bZ.$1;b3=bZ.$0;bY(b3);bZ=b2;}}}bX=[];bY(bW.Children);return{$:0,$0:bn.ofSeqNonCopying(bX)};};bJ.Clear=function(bW){bW.splice(0,p.length(bW));};bK.IsWhiteSpace=function(bW){return bW.match(new a.RegExp("\\s"))!==null;};Q.TryParse=function(bW,bX,bY,bZ){var b0,b1;b0=+bW;b1=b0===b0-b0%1&&b0>=bX&&b0<=bY;b1?bZ.set(b0):void 0;return b1;};bL.Create=function(bW){return bO.New(false,bW,bL.forceLazy);};bL.forceLazy=function(){var bW;bW=this.v();this.c=true;this.v=bW;this.f=bL.cachedLazy;return bW;};bL.cachedLazy=function(){return this.v;};bM.$cctor=function(){bM.$cctor=a.ignore;bM.Empty={$:0};};bO.New=function(bW,bX,bY){return{c:bW,v:bX,f:bY};};bT.OnLoad(function(){c.Main();});}());


if (typeof IntelliFactory !=='undefined') {
  IntelliFactory.Runtime.ScriptBasePath = '/Content/';
  IntelliFactory.Runtime.Start();
}
